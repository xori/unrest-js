{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/component-emitter/index.js","unrest.min.js","node_modules/reduce-component/index.js","node_modules/superagent/lib/client.js","src/database.js","src/src/main.js","src/request.js","src/table.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","Emitter","obj","mixin","key","prototype","on","addEventListener","event","fn","this","_callbacks","push","once","self","off","apply","arguments","removeListener","removeAllListeners","removeEventListener","callbacks","cb","splice","emit","args","slice","len","listeners","hasListeners",2,"arr","initial","idx","curr",3,"noop","isHost","str","toString","isObject","Object","serialize","pairs","pushEncodedKeyValuePair","join","val","Array","isArray","forEach","v","encodeURIComponent","parseString","parts","pair","split","decodeURIComponent","parseHeader","index","line","field","lines","fields","pop","indexOf","toLowerCase","trim","isJSON","mime","test","type","shift","params","reduce","Response","req","options","xhr","text","method","responseType","responseText","statusText","setStatusProperties","status","header","headers","getAllResponseHeaders","getResponseHeader","setHeaderProperties","body","parseBody","response","Request","url","_query","_header","err","res","parse","original","rawResponse","callback","new_err","request","end","del","root","window","getXHR","XMLHttpRequest","location","protocol","ActiveXObject","replace","serializeObject","types","html","json","xml","urlencoded","form","form-data","application/x-www-form-urlencoded","application/json","JSON","stringify","get","ct","statusCode","statusType","info","ok","clientError","serverError","error","toError","accepted","noContent","badRequest","unauthorized","notAcceptable","notFound","forbidden","msg","use","timeout","ms","_timeout","clearTimeout","_timer","abort","aborted","set","unset","getHeader","_parser","accept","auth","user","pass","btoa","query","name","_formData","FormData","append","attach","file","filename","send","data","_data","_callback","crossDomainError","crossDomain","timeoutError","withCredentials","_withCredentials","onreadystatechange","readyState","timedout","handleProgress","total","percent","loaded","onprogress","upload","setTimeout","open","contentType","setRequestHeader","then","fulfill","reject","head","patch","post","put","emitter",4,"_classCallCheck","instance","Constructor","TypeError","Table","Database","match","cacheTTL","cacheByDefault","storage","localStorage","plugins","_database","table","plugin","./table",5,"global","Unrest","superagent","./database",6,"_typeof","Symbol","constructor","jsonify","agent","handleResponses","_status","_agent","CACHE_KEY","storageProvider","_table","_cache","cache","getItem","time","Date","_onSuccess","_cachedata","removeItem","_onError","setItem","prop","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","value","lifetime","console","id","Id",7,"database","events","fetch","object","save","remove","cacheable","./request"],"mappings":"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","file":"unrest.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\n/**\n * Expose `Emitter`.\n */\n\nmodule.exports = Emitter;\n\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n};\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks[event] = this._callbacks[event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  var self = this;\n  this._callbacks = this._callbacks || {};\n\n  function on() {\n    self.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks[event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks[event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n  var args = [].slice.call(arguments, 1)\n    , callbacks = this._callbacks[event];\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks[event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\n/**\n * Expose `Emitter`.\n */\n\nmodule.exports = Emitter;\n\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n};\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks[event] = this._callbacks[event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  var self = this;\n  this._callbacks = this._callbacks || {};\n\n  function on() {\n    self.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks[event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks[event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n  var args = [].slice.call(arguments, 1)\n    , callbacks = this._callbacks[event];\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks[event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n\n},{}],2:[function(require,module,exports){\n\n/**\n * Reduce `arr` with `fn`.\n *\n * @param {Array} arr\n * @param {Function} fn\n * @param {Mixed} initial\n *\n * TODO: combatible error handling?\n */\n\nmodule.exports = function(arr, fn, initial){  \n  var idx = 0;\n  var len = arr.length;\n  var curr = arguments.length == 3\n    ? initial\n    : arr[idx++];\n\n  while (idx < len) {\n    curr = fn.call(null, curr, arr[idx], ++idx, arr);\n  }\n  \n  return curr;\n};\n},{}],3:[function(require,module,exports){\n/**\n * Module dependencies.\n */\n\nvar Emitter = require('emitter');\nvar reduce = require('reduce');\n\n/**\n * Root reference for iframes.\n */\n\nvar root;\nif (typeof window !== 'undefined') { // Browser window\n  root = window;\n} else if (typeof self !== 'undefined') { // Web Worker\n  root = self;\n} else { // Other environments\n  root = this;\n}\n\n/**\n * Noop.\n */\n\nfunction noop(){};\n\n/**\n * Check if `obj` is a host object,\n * we don't want to serialize these :)\n *\n * TODO: future proof, move to compoent land\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isHost(obj) {\n  var str = {}.toString.call(obj);\n\n  switch (str) {\n    case '[object File]':\n    case '[object Blob]':\n    case '[object FormData]':\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Determine XHR.\n */\n\nrequest.getXHR = function () {\n  if (root.XMLHttpRequest\n      && (!root.location || 'file:' != root.location.protocol\n          || !root.ActiveXObject)) {\n    return new XMLHttpRequest;\n  } else {\n    try { return new ActiveXObject('Microsoft.XMLHTTP'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.6.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.3.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP'); } catch(e) {}\n  }\n  return false;\n};\n\n/**\n * Removes leading and trailing whitespace, added to support IE.\n *\n * @param {String} s\n * @return {String}\n * @api private\n */\n\nvar trim = ''.trim\n  ? function(s) { return s.trim(); }\n  : function(s) { return s.replace(/(^\\s*|\\s*$)/g, ''); };\n\n/**\n * Check if `obj` is an object.\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Serialize the given `obj`.\n *\n * @param {Object} obj\n * @return {String}\n * @api private\n */\n\nfunction serialize(obj) {\n  if (!isObject(obj)) return obj;\n  var pairs = [];\n  for (var key in obj) {\n    if (null != obj[key]) {\n      pushEncodedKeyValuePair(pairs, key, obj[key]);\n        }\n      }\n  return pairs.join('&');\n}\n\n/**\n * Helps 'serialize' with serializing arrays.\n * Mutates the pairs array.\n *\n * @param {Array} pairs\n * @param {String} key\n * @param {Mixed} val\n */\n\nfunction pushEncodedKeyValuePair(pairs, key, val) {\n  if (Array.isArray(val)) {\n    return val.forEach(function(v) {\n      pushEncodedKeyValuePair(pairs, key, v);\n    });\n  }\n  pairs.push(encodeURIComponent(key)\n    + '=' + encodeURIComponent(val));\n}\n\n/**\n * Expose serialization method.\n */\n\n request.serializeObject = serialize;\n\n /**\n  * Parse the given x-www-form-urlencoded `str`.\n  *\n  * @param {String} str\n  * @return {Object}\n  * @api private\n  */\n\nfunction parseString(str) {\n  var obj = {};\n  var pairs = str.split('&');\n  var parts;\n  var pair;\n\n  for (var i = 0, len = pairs.length; i < len; ++i) {\n    pair = pairs[i];\n    parts = pair.split('=');\n    obj[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);\n  }\n\n  return obj;\n}\n\n/**\n * Expose parser.\n */\n\nrequest.parseString = parseString;\n\n/**\n * Default MIME type map.\n *\n *     superagent.types.xml = 'application/xml';\n *\n */\n\nrequest.types = {\n  html: 'text/html',\n  json: 'application/json',\n  xml: 'application/xml',\n  urlencoded: 'application/x-www-form-urlencoded',\n  'form': 'application/x-www-form-urlencoded',\n  'form-data': 'application/x-www-form-urlencoded'\n};\n\n/**\n * Default serialization map.\n *\n *     superagent.serialize['application/xml'] = function(obj){\n *       return 'generated xml here';\n *     };\n *\n */\n\n request.serialize = {\n   'application/x-www-form-urlencoded': serialize,\n   'application/json': JSON.stringify\n };\n\n /**\n  * Default parsers.\n  *\n  *     superagent.parse['application/xml'] = function(str){\n  *       return { object parsed from str };\n  *     };\n  *\n  */\n\nrequest.parse = {\n  'application/x-www-form-urlencoded': parseString,\n  'application/json': JSON.parse\n};\n\n/**\n * Parse the given header `str` into\n * an object containing the mapped fields.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction parseHeader(str) {\n  var lines = str.split(/\\r?\\n/);\n  var fields = {};\n  var index;\n  var line;\n  var field;\n  var val;\n\n  lines.pop(); // trailing CRLF\n\n  for (var i = 0, len = lines.length; i < len; ++i) {\n    line = lines[i];\n    index = line.indexOf(':');\n    field = line.slice(0, index).toLowerCase();\n    val = trim(line.slice(index + 1));\n    fields[field] = val;\n  }\n\n  return fields;\n}\n\n/**\n * Check if `mime` is json or has +json structured syntax suffix.\n *\n * @param {String} mime\n * @return {Boolean}\n * @api private\n */\n\nfunction isJSON(mime) {\n  return /[\\/+]json\\b/.test(mime);\n}\n\n/**\n * Return the mime type for the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nfunction type(str){\n  return str.split(/ *; */).shift();\n};\n\n/**\n * Return header field parameters.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction params(str){\n  return reduce(str.split(/ *; */), function(obj, str){\n    var parts = str.split(/ *= */)\n      , key = parts.shift()\n      , val = parts.shift();\n\n    if (key && val) obj[key] = val;\n    return obj;\n  }, {});\n};\n\n/**\n * Initialize a new `Response` with the given `xhr`.\n *\n *  - set flags (.ok, .error, etc)\n *  - parse header\n *\n * Examples:\n *\n *  Aliasing `superagent` as `request` is nice:\n *\n *      request = superagent;\n *\n *  We can use the promise-like API, or pass callbacks:\n *\n *      request.get('/').end(function(res){});\n *      request.get('/', function(res){});\n *\n *  Sending data can be chained:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' })\n *        .end(function(res){});\n *\n *  Or passed to `.send()`:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' }, function(res){});\n *\n *  Or passed to `.post()`:\n *\n *      request\n *        .post('/user', { name: 'tj' })\n *        .end(function(res){});\n *\n * Or further reduced to a single call for simple cases:\n *\n *      request\n *        .post('/user', { name: 'tj' }, function(res){});\n *\n * @param {XMLHTTPRequest} xhr\n * @param {Object} options\n * @api private\n */\n\nfunction Response(req, options) {\n  options = options || {};\n  this.req = req;\n  this.xhr = this.req.xhr;\n  // responseText is accessible only if responseType is '' or 'text' and on older browsers\n  this.text = ((this.req.method !='HEAD' && (this.xhr.responseType === '' || this.xhr.responseType === 'text')) || typeof this.xhr.responseType === 'undefined')\n     ? this.xhr.responseText\n     : null;\n  this.statusText = this.req.xhr.statusText;\n  this.setStatusProperties(this.xhr.status);\n  this.header = this.headers = parseHeader(this.xhr.getAllResponseHeaders());\n  // getAllResponseHeaders sometimes falsely returns \"\" for CORS requests, but\n  // getResponseHeader still works. so we get content-type even if getting\n  // other headers fails.\n  this.header['content-type'] = this.xhr.getResponseHeader('content-type');\n  this.setHeaderProperties(this.header);\n  this.body = this.req.method != 'HEAD'\n    ? this.parseBody(this.text ? this.text : this.xhr.response)\n    : null;\n}\n\n/**\n * Get case-insensitive `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api public\n */\n\nResponse.prototype.get = function(field){\n  return this.header[field.toLowerCase()];\n};\n\n/**\n * Set header related properties:\n *\n *   - `.type` the content type without params\n *\n * A response of \"Content-Type: text/plain; charset=utf-8\"\n * will provide you with a `.type` of \"text/plain\".\n *\n * @param {Object} header\n * @api private\n */\n\nResponse.prototype.setHeaderProperties = function(header){\n  // content-type\n  var ct = this.header['content-type'] || '';\n  this.type = type(ct);\n\n  // params\n  var obj = params(ct);\n  for (var key in obj) this[key] = obj[key];\n};\n\n/**\n * Parse the given body `str`.\n *\n * Used for auto-parsing of bodies. Parsers\n * are defined on the `superagent.parse` object.\n *\n * @param {String} str\n * @return {Mixed}\n * @api private\n */\n\nResponse.prototype.parseBody = function(str){\n  var parse = request.parse[this.type];\n  return parse && str && (str.length || str instanceof Object)\n    ? parse(str)\n    : null;\n};\n\n/**\n * Set flags such as `.ok` based on `status`.\n *\n * For example a 2xx response will give you a `.ok` of __true__\n * whereas 5xx will be __false__ and `.error` will be __true__. The\n * `.clientError` and `.serverError` are also available to be more\n * specific, and `.statusType` is the class of error ranging from 1..5\n * sometimes useful for mapping respond colors etc.\n *\n * \"sugar\" properties are also defined for common cases. Currently providing:\n *\n *   - .noContent\n *   - .badRequest\n *   - .unauthorized\n *   - .notAcceptable\n *   - .notFound\n *\n * @param {Number} status\n * @api private\n */\n\nResponse.prototype.setStatusProperties = function(status){\n  // handle IE9 bug: http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n  if (status === 1223) {\n    status = 204;\n  }\n\n  var type = status / 100 | 0;\n\n  // status / class\n  this.status = this.statusCode = status;\n  this.statusType = type;\n\n  // basics\n  this.info = 1 == type;\n  this.ok = 2 == type;\n  this.clientError = 4 == type;\n  this.serverError = 5 == type;\n  this.error = (4 == type || 5 == type)\n    ? this.toError()\n    : false;\n\n  // sugar\n  this.accepted = 202 == status;\n  this.noContent = 204 == status;\n  this.badRequest = 400 == status;\n  this.unauthorized = 401 == status;\n  this.notAcceptable = 406 == status;\n  this.notFound = 404 == status;\n  this.forbidden = 403 == status;\n};\n\n/**\n * Return an `Error` representative of this response.\n *\n * @return {Error}\n * @api public\n */\n\nResponse.prototype.toError = function(){\n  var req = this.req;\n  var method = req.method;\n  var url = req.url;\n\n  var msg = 'cannot ' + method + ' ' + url + ' (' + this.status + ')';\n  var err = new Error(msg);\n  err.status = this.status;\n  err.method = method;\n  err.url = url;\n\n  return err;\n};\n\n/**\n * Expose `Response`.\n */\n\nrequest.Response = Response;\n\n/**\n * Initialize a new `Request` with the given `method` and `url`.\n *\n * @param {String} method\n * @param {String} url\n * @api public\n */\n\nfunction Request(method, url) {\n  var self = this;\n  Emitter.call(this);\n  this._query = this._query || [];\n  this.method = method;\n  this.url = url;\n  this.header = {};\n  this._header = {};\n  this.on('end', function(){\n    var err = null;\n    var res = null;\n\n    try {\n      res = new Response(self);\n    } catch(e) {\n      err = new Error('Parser is unable to parse the response');\n      err.parse = true;\n      err.original = e;\n      // issue #675: return the raw response if the response parsing fails\n      err.rawResponse = self.xhr && self.xhr.responseText ? self.xhr.responseText : null;\n      return self.callback(err);\n    }\n\n    self.emit('response', res);\n\n    if (err) {\n      return self.callback(err, res);\n    }\n\n    if (res.status >= 200 && res.status < 300) {\n      return self.callback(err, res);\n    }\n\n    var new_err = new Error(res.statusText || 'Unsuccessful HTTP response');\n    new_err.original = err;\n    new_err.response = res;\n    new_err.status = res.status;\n\n    self.callback(new_err, res);\n  });\n}\n\n/**\n * Mixin `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Allow for extension\n */\n\nRequest.prototype.use = function(fn) {\n  fn(this);\n  return this;\n}\n\n/**\n * Set timeout to `ms`.\n *\n * @param {Number} ms\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.timeout = function(ms){\n  this._timeout = ms;\n  return this;\n};\n\n/**\n * Clear previous timeout.\n *\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.clearTimeout = function(){\n  this._timeout = 0;\n  clearTimeout(this._timer);\n  return this;\n};\n\n/**\n * Abort the request, and clear potential timeout.\n *\n * @return {Request}\n * @api public\n */\n\nRequest.prototype.abort = function(){\n  if (this.aborted) return;\n  this.aborted = true;\n  this.xhr.abort();\n  this.clearTimeout();\n  this.emit('abort');\n  return this;\n};\n\n/**\n * Set header `field` to `val`, or multiple fields with one object.\n *\n * Examples:\n *\n *      req.get('/')\n *        .set('Accept', 'application/json')\n *        .set('X-API-Key', 'foobar')\n *        .end(callback);\n *\n *      req.get('/')\n *        .set({ Accept: 'application/json', 'X-API-Key': 'foobar' })\n *        .end(callback);\n *\n * @param {String|Object} field\n * @param {String} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.set = function(field, val){\n  if (isObject(field)) {\n    for (var key in field) {\n      this.set(key, field[key]);\n    }\n    return this;\n  }\n  this._header[field.toLowerCase()] = val;\n  this.header[field] = val;\n  return this;\n};\n\n/**\n * Remove header `field`.\n *\n * Example:\n *\n *      req.get('/')\n *        .unset('User-Agent')\n *        .end(callback);\n *\n * @param {String} field\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.unset = function(field){\n  delete this._header[field.toLowerCase()];\n  delete this.header[field];\n  return this;\n};\n\n/**\n * Get case-insensitive header `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api private\n */\n\nRequest.prototype.getHeader = function(field){\n  return this._header[field.toLowerCase()];\n};\n\n/**\n * Set Content-Type to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.xml = 'application/xml';\n *\n *      request.post('/')\n *        .type('xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n *      request.post('/')\n *        .type('application/xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n * @param {String} type\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.type = function(type){\n  this.set('Content-Type', request.types[type] || type);\n  return this;\n};\n\n/**\n * Force given parser\n *\n * Sets the body parser no matter type.\n *\n * @param {Function}\n * @api public\n */\n\nRequest.prototype.parse = function(fn){\n  this._parser = fn;\n  return this;\n};\n\n/**\n * Set Accept to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.json = 'application/json';\n *\n *      request.get('/agent')\n *        .accept('json')\n *        .end(callback);\n *\n *      request.get('/agent')\n *        .accept('application/json')\n *        .end(callback);\n *\n * @param {String} accept\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.accept = function(type){\n  this.set('Accept', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Authorization field value with `user` and `pass`.\n *\n * @param {String} user\n * @param {String} pass\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.auth = function(user, pass){\n  var str = btoa(user + ':' + pass);\n  this.set('Authorization', 'Basic ' + str);\n  return this;\n};\n\n/**\n* Add query-string `val`.\n*\n* Examples:\n*\n*   request.get('/shoes')\n*     .query('size=10')\n*     .query({ color: 'blue' })\n*\n* @param {Object|String} val\n* @return {Request} for chaining\n* @api public\n*/\n\nRequest.prototype.query = function(val){\n  if ('string' != typeof val) val = serialize(val);\n  if (val) this._query.push(val);\n  return this;\n};\n\n/**\n * Write the field `name` and `val` for \"multipart/form-data\"\n * request bodies.\n *\n * ``` js\n * request.post('/upload')\n *   .field('foo', 'bar')\n *   .end(callback);\n * ```\n *\n * @param {String} name\n * @param {String|Blob|File} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.field = function(name, val){\n  if (!this._formData) this._formData = new root.FormData();\n  this._formData.append(name, val);\n  return this;\n};\n\n/**\n * Queue the given `file` as an attachment to the specified `field`,\n * with optional `filename`.\n *\n * ``` js\n * request.post('/upload')\n *   .attach(new Blob(['<a id=\"a\"><b id=\"b\">hey!</b></a>'], { type: \"text/html\"}))\n *   .end(callback);\n * ```\n *\n * @param {String} field\n * @param {Blob|File} file\n * @param {String} filename\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.attach = function(field, file, filename){\n  if (!this._formData) this._formData = new root.FormData();\n  this._formData.append(field, file, filename);\n  return this;\n};\n\n/**\n * Send `data`, defaulting the `.type()` to \"json\" when\n * an object is given.\n *\n * Examples:\n *\n *       // querystring\n *       request.get('/search')\n *         .end(callback)\n *\n *       // multiple data \"writes\"\n *       request.get('/search')\n *         .send({ search: 'query' })\n *         .send({ range: '1..5' })\n *         .send({ order: 'desc' })\n *         .end(callback)\n *\n *       // manual json\n *       request.post('/user')\n *         .type('json')\n *         .send('{\"name\":\"tj\"}')\n *         .end(callback)\n *\n *       // auto json\n *       request.post('/user')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // manual x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send('name=tj')\n *         .end(callback)\n *\n *       // auto x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // defaults to x-www-form-urlencoded\n  *      request.post('/user')\n  *        .send('name=tobi')\n  *        .send('species=ferret')\n  *        .end(callback)\n *\n * @param {String|Object} data\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.send = function(data){\n  var obj = isObject(data);\n  var type = this.getHeader('Content-Type');\n\n  // merge\n  if (obj && isObject(this._data)) {\n    for (var key in data) {\n      this._data[key] = data[key];\n    }\n  } else if ('string' == typeof data) {\n    if (!type) this.type('form');\n    type = this.getHeader('Content-Type');\n    if ('application/x-www-form-urlencoded' == type) {\n      this._data = this._data\n        ? this._data + '&' + data\n        : data;\n    } else {\n      this._data = (this._data || '') + data;\n    }\n  } else {\n    this._data = data;\n  }\n\n  if (!obj || isHost(data)) return this;\n  if (!type) this.type('json');\n  return this;\n};\n\n/**\n * Invoke the callback with `err` and `res`\n * and handle arity check.\n *\n * @param {Error} err\n * @param {Response} res\n * @api private\n */\n\nRequest.prototype.callback = function(err, res){\n  var fn = this._callback;\n  this.clearTimeout();\n  fn(err, res);\n};\n\n/**\n * Invoke callback with x-domain error.\n *\n * @api private\n */\n\nRequest.prototype.crossDomainError = function(){\n  var err = new Error('Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.');\n  err.crossDomain = true;\n\n  err.status = this.status;\n  err.method = this.method;\n  err.url = this.url;\n\n  this.callback(err);\n};\n\n/**\n * Invoke callback with timeout error.\n *\n * @api private\n */\n\nRequest.prototype.timeoutError = function(){\n  var timeout = this._timeout;\n  var err = new Error('timeout of ' + timeout + 'ms exceeded');\n  err.timeout = timeout;\n  this.callback(err);\n};\n\n/**\n * Enable transmission of cookies with x-domain requests.\n *\n * Note that for this to work the origin must not be\n * using \"Access-Control-Allow-Origin\" with a wildcard,\n * and also must set \"Access-Control-Allow-Credentials\"\n * to \"true\".\n *\n * @api public\n */\n\nRequest.prototype.withCredentials = function(){\n  this._withCredentials = true;\n  return this;\n};\n\n/**\n * Initiate request, invoking callback `fn(res)`\n * with an instanceof `Response`.\n *\n * @param {Function} fn\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.end = function(fn){\n  var self = this;\n  var xhr = this.xhr = request.getXHR();\n  var query = this._query.join('&');\n  var timeout = this._timeout;\n  var data = this._formData || this._data;\n\n  // store callback\n  this._callback = fn || noop;\n\n  // state change\n  xhr.onreadystatechange = function(){\n    if (4 != xhr.readyState) return;\n\n    // In IE9, reads to any property (e.g. status) off of an aborted XHR will\n    // result in the error \"Could not complete the operation due to error c00c023f\"\n    var status;\n    try { status = xhr.status } catch(e) { status = 0; }\n\n    if (0 == status) {\n      if (self.timedout) return self.timeoutError();\n      if (self.aborted) return;\n      return self.crossDomainError();\n    }\n    self.emit('end');\n  };\n\n  // progress\n  var handleProgress = function(e){\n    if (e.total > 0) {\n      e.percent = e.loaded / e.total * 100;\n    }\n    self.emit('progress', e);\n  };\n  if (this.hasListeners('progress')) {\n    xhr.onprogress = handleProgress;\n  }\n  try {\n    if (xhr.upload && this.hasListeners('progress')) {\n      xhr.upload.onprogress = handleProgress;\n    }\n  } catch(e) {\n    // Accessing xhr.upload fails in IE from a web worker, so just pretend it doesn't exist.\n    // Reported here:\n    // https://connect.microsoft.com/IE/feedback/details/837245/xmlhttprequest-upload-throws-invalid-argument-when-used-from-web-worker-context\n  }\n\n  // timeout\n  if (timeout && !this._timer) {\n    this._timer = setTimeout(function(){\n      self.timedout = true;\n      self.abort();\n    }, timeout);\n  }\n\n  // querystring\n  if (query) {\n    query = request.serializeObject(query);\n    this.url += ~this.url.indexOf('?')\n      ? '&' + query\n      : '?' + query;\n  }\n\n  // initiate request\n  xhr.open(this.method, this.url, true);\n\n  // CORS\n  if (this._withCredentials) xhr.withCredentials = true;\n\n  // body\n  if ('GET' != this.method && 'HEAD' != this.method && 'string' != typeof data && !isHost(data)) {\n    // serialize stuff\n    var contentType = this.getHeader('Content-Type');\n    var serialize = this._parser || request.serialize[contentType ? contentType.split(';')[0] : ''];\n    if (!serialize && isJSON(contentType)) serialize = request.serialize['application/json'];\n    if (serialize) data = serialize(data);\n  }\n\n  // set header fields\n  for (var field in this.header) {\n    if (null == this.header[field]) continue;\n    xhr.setRequestHeader(field, this.header[field]);\n  }\n\n  // send stuff\n  this.emit('request', this);\n\n  // IE11 xhr.send(undefined) sends 'undefined' string as POST payload (instead of nothing)\n  // We need null here if data is undefined\n  xhr.send(typeof data !== 'undefined' ? data : null);\n  return this;\n};\n\n/**\n * Faux promise support\n *\n * @param {Function} fulfill\n * @param {Function} reject\n * @return {Request}\n */\n\nRequest.prototype.then = function (fulfill, reject) {\n  return this.end(function(err, res) {\n    err ? reject(err) : fulfill(res);\n  });\n}\n\n/**\n * Expose `Request`.\n */\n\nrequest.Request = Request;\n\n/**\n * Issue a request:\n *\n * Examples:\n *\n *    request('GET', '/users').end(callback)\n *    request('/users').end(callback)\n *    request('/users', callback)\n *\n * @param {String} method\n * @param {String|Function} url or callback\n * @return {Request}\n * @api public\n */\n\nfunction request(method, url) {\n  // callback\n  if ('function' == typeof url) {\n    return new Request('GET', method).end(url);\n  }\n\n  // url first\n  if (1 == arguments.length) {\n    return new Request('GET', method);\n  }\n\n  return new Request(method, url);\n}\n\n/**\n * GET `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.get = function(url, data, fn){\n  var req = request('GET', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.query(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * HEAD `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.head = function(url, data, fn){\n  var req = request('HEAD', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * DELETE `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nfunction del(url, fn){\n  var req = request('DELETE', url);\n  if (fn) req.end(fn);\n  return req;\n};\n\nrequest.del = del;\nrequest.delete = del;\n\n/**\n * PATCH `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.patch = function(url, data, fn){\n  var req = request('PATCH', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * POST `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.post = function(url, data, fn){\n  var req = request('POST', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * PUT `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.put = function(url, data, fn){\n  var req = request('PUT', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * Expose `request`.\n */\n\nmodule.exports = request;\n\n},{\"emitter\":1,\"reduce\":2}],4:[function(require,module,exports){\n'use strict';\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/* global localStorage */\nvar Table = require('./table');\n\nmodule.exports = function Database(name, options) {\n  _classCallCheck(this, Database);\n\n  this.url = name || '/api/';\n  if (!this.url.match(/\\/$/)) {\n    this.url += '/';\n  }\n\n  options = options | {};\n  this.cacheTTL = options.cacheTTL || 10 * 60 * 1000; // 10 minutes\n  this.cacheByDefault = options.cacheByDefault || false;\n  this.storage = options.storage || localStorage;\n  this.plugins = options.plugins || [];\n\n  var self = this;\n  var _database = function _database(table) {\n    return new Table(self, table);\n  };\n  // `public` functions\n  this.plugins.forEach(function (plugin) {\n    plugin.call(self);\n  });\n\n  return _database;\n};\n\n},{\"./table\":7}],5:[function(require,module,exports){\n(function (global){\n'use strict';\n\n// The Export Module\nglobal.Unrest = require('./database');\nglobal.Unrest.superagent = require('superagent');\n\nmodule.exports = global.Unrest;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{\"./database\":4,\"superagent\":3}],6:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { return obj && typeof Symbol !== \"undefined\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; }\n\nvar xhr = require('superagent');\n\nfunction jsonify(agent) {\n  return agent.type('application/json').accept('json');\n}\n\nfunction handleResponses(request) {\n  request._status = 'pending';\n  var method = request._agent.method;\n  var url = request._agent.url;\n  var CACHE_KEY = 'unrest-' + method + '-' + url;\n  var storageProvider = request._table._database.storage;\n\n  // //\n  // Perform Cache\n  if (request._cache) {\n    var cache = JSON.parse(storageProvider.getItem(CACHE_KEY));\n\n    if (cache) {\n      // if the cache exists and isn't old\n      if (cache.time && request._cache > +new Date() - cache.time) {\n        request._onSuccess.forEach(function (cb) {\n          cb(cache.data, true);\n        });\n        request._cachedata = cache.data;\n      } else {\n        storageProvider.removeItem(CACHE_KEY);\n      }\n    }\n  }\n\n  // //\n  // Handle Response\n  request._agent.end(function (err, res) {\n    request._status = 'resolved';\n    if (err) {\n      // on error\n      request.error = err;\n      request._onError.forEach(function (cb) {\n        cb(err);\n      });\n    } else {\n      // on success\n      request._data = res.body;\n      if (request._cache) {\n        storageProvider.setItem(CACHE_KEY, JSON.stringify({ time: +new Date(), data: request._data }));\n      }\n      // //\n      // perform injection\n      if (_typeof(res.body) === 'object' && !Array.isArray(res.body)) {\n        for (var prop in request._data) {\n          request[prop] = request._data[prop];\n        }\n      } else {\n        request.data = request._data;\n      }\n      // //\n      // perform calbacks.\n      request._onSuccess.forEach(function (cb) {\n        cb(res.body);\n      });\n    }\n  });\n}\n\nmodule.exports = (function () {\n  function Request(table) {\n    _classCallCheck(this, Request);\n\n    this._table = table;\n    this._status = 'idle';\n    this._onSuccess = [];\n    this._onError = [];\n    if (this._table._database.cacheByDefault) {\n      this._cache = this._table._database.cacheTTL;\n    }\n  }\n\n  _createClass(Request, [{\n    key: 'cacheable',\n    value: function cacheable(lifetime) {\n      if (this._status !== 'idle' && this._status !== 'pending') {\n        console.error('cacheable could not be set before request was sent out. Ensure this is called before query, fetch, save, then, etc');\n      }\n      if (!lifetime) {\n        lifetime = this._table._database.cacheTTL;\n      }\n      this._cache = lifetime;\n      return this;\n    }\n\n    // QUERY GET /table/\n    // Returns a list.\n\n  }, {\n    key: 'query',\n    value: function query(options) {\n      this._agent = xhr.get(this._table.url).query(options);\n      jsonify(this._agent);\n      if (this._status === 'idle') handleResponses(this);\n      return this;\n    }\n  }, {\n    key: 'fetch',\n    value: function fetch(id, options) {\n      this._agent = xhr.get(this._table.url + '/' + id.toString()).query(options);\n      jsonify(this._agent);\n      if (this._status === 'idle') handleResponses(this);\n      return this;\n    }\n  }, {\n    key: 'save',\n    value: function save(obj) {\n      var r = null;\n      var id = obj.Id || obj.id;\n      if (!id || id === 0) {\n        r = xhr.post(this._table.url);\n      } else {\n        r = xhr.put(this._table.url + '/' + id);\n      }\n      this._agent = r.send(obj);\n      jsonify(this._agent);\n      if (this._status === 'idle') handleResponses(this);\n      return this;\n    }\n  }, {\n    key: 'remove',\n    value: function remove(Id) {\n      this._agent = xhr.del(this._table.url + '/' + Id);\n      jsonify(this._agent);\n      return this;\n    }\n  }, {\n    key: 'then',\n    value: function then(cb) {\n      if (this._status === 'resolved' && !this.error) {\n        cb(this._data);\n      } else {\n        this._onSuccess.push(cb);\n      }\n      if (this._status === 'idle') handleResponses(this);\n      if (this._status === 'pending' && this._cachedata) {\n        cb(this._cachedata, true);\n      }\n      return this;\n    }\n  }, {\n    key: 'catch',\n    value: function _catch(cb) {\n      if (this._status === 'resolved' && this.error) {\n        cb(this.error);\n      } else {\n        this._onError.push(cb);\n      }\n      if (this._status === 'idle') handleResponses(this);\n      return this;\n    }\n  }, {\n    key: 'status',\n    value: function status() {\n      return this._status;\n    }\n  }]);\n\n  return Request;\n})();\n\n},{\"superagent\":3}],7:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Request = require('./request');\n\nmodule.exports = (function () {\n  function Table(database, table) {\n    _classCallCheck(this, Table);\n\n    this._database = database;\n    this.url = database.url + table;\n    this.name = table;\n    this.events = {};\n  }\n\n  _createClass(Table, [{\n    key: 'query',\n    value: function query(options) {\n      return new Request(this).query(options);\n    }\n  }, {\n    key: 'fetch',\n    value: function fetch(id) {\n      return new Request(this).fetch(id);\n    }\n  }, {\n    key: 'save',\n    value: function save(object) {\n      return new Request(this).save(object);\n    }\n  }, {\n    key: 'remove',\n    value: function remove(obj) {\n      return new Request(this).remove(obj);\n    }\n  }, {\n    key: 'cacheable',\n    value: function cacheable(obj) {\n      return new Request(this).cacheable(obj);\n    }\n  }]);\n\n  return Table;\n})();\n\n},{\"./request\":6}]},{},[5])\n\n","\n/**\n * Reduce `arr` with `fn`.\n *\n * @param {Array} arr\n * @param {Function} fn\n * @param {Mixed} initial\n *\n * TODO: combatible error handling?\n */\n\nmodule.exports = function(arr, fn, initial){  \n  var idx = 0;\n  var len = arr.length;\n  var curr = arguments.length == 3\n    ? initial\n    : arr[idx++];\n\n  while (idx < len) {\n    curr = fn.call(null, curr, arr[idx], ++idx, arr);\n  }\n  \n  return curr;\n};","/**\n * Module dependencies.\n */\n\nvar Emitter = require('emitter');\nvar reduce = require('reduce');\n\n/**\n * Root reference for iframes.\n */\n\nvar root;\nif (typeof window !== 'undefined') { // Browser window\n  root = window;\n} else if (typeof self !== 'undefined') { // Web Worker\n  root = self;\n} else { // Other environments\n  root = this;\n}\n\n/**\n * Noop.\n */\n\nfunction noop(){};\n\n/**\n * Check if `obj` is a host object,\n * we don't want to serialize these :)\n *\n * TODO: future proof, move to compoent land\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isHost(obj) {\n  var str = {}.toString.call(obj);\n\n  switch (str) {\n    case '[object File]':\n    case '[object Blob]':\n    case '[object FormData]':\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Determine XHR.\n */\n\nrequest.getXHR = function () {\n  if (root.XMLHttpRequest\n      && (!root.location || 'file:' != root.location.protocol\n          || !root.ActiveXObject)) {\n    return new XMLHttpRequest;\n  } else {\n    try { return new ActiveXObject('Microsoft.XMLHTTP'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.6.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.3.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP'); } catch(e) {}\n  }\n  return false;\n};\n\n/**\n * Removes leading and trailing whitespace, added to support IE.\n *\n * @param {String} s\n * @return {String}\n * @api private\n */\n\nvar trim = ''.trim\n  ? function(s) { return s.trim(); }\n  : function(s) { return s.replace(/(^\\s*|\\s*$)/g, ''); };\n\n/**\n * Check if `obj` is an object.\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Serialize the given `obj`.\n *\n * @param {Object} obj\n * @return {String}\n * @api private\n */\n\nfunction serialize(obj) {\n  if (!isObject(obj)) return obj;\n  var pairs = [];\n  for (var key in obj) {\n    if (null != obj[key]) {\n      pushEncodedKeyValuePair(pairs, key, obj[key]);\n        }\n      }\n  return pairs.join('&');\n}\n\n/**\n * Helps 'serialize' with serializing arrays.\n * Mutates the pairs array.\n *\n * @param {Array} pairs\n * @param {String} key\n * @param {Mixed} val\n */\n\nfunction pushEncodedKeyValuePair(pairs, key, val) {\n  if (Array.isArray(val)) {\n    return val.forEach(function(v) {\n      pushEncodedKeyValuePair(pairs, key, v);\n    });\n  }\n  pairs.push(encodeURIComponent(key)\n    + '=' + encodeURIComponent(val));\n}\n\n/**\n * Expose serialization method.\n */\n\n request.serializeObject = serialize;\n\n /**\n  * Parse the given x-www-form-urlencoded `str`.\n  *\n  * @param {String} str\n  * @return {Object}\n  * @api private\n  */\n\nfunction parseString(str) {\n  var obj = {};\n  var pairs = str.split('&');\n  var parts;\n  var pair;\n\n  for (var i = 0, len = pairs.length; i < len; ++i) {\n    pair = pairs[i];\n    parts = pair.split('=');\n    obj[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);\n  }\n\n  return obj;\n}\n\n/**\n * Expose parser.\n */\n\nrequest.parseString = parseString;\n\n/**\n * Default MIME type map.\n *\n *     superagent.types.xml = 'application/xml';\n *\n */\n\nrequest.types = {\n  html: 'text/html',\n  json: 'application/json',\n  xml: 'application/xml',\n  urlencoded: 'application/x-www-form-urlencoded',\n  'form': 'application/x-www-form-urlencoded',\n  'form-data': 'application/x-www-form-urlencoded'\n};\n\n/**\n * Default serialization map.\n *\n *     superagent.serialize['application/xml'] = function(obj){\n *       return 'generated xml here';\n *     };\n *\n */\n\n request.serialize = {\n   'application/x-www-form-urlencoded': serialize,\n   'application/json': JSON.stringify\n };\n\n /**\n  * Default parsers.\n  *\n  *     superagent.parse['application/xml'] = function(str){\n  *       return { object parsed from str };\n  *     };\n  *\n  */\n\nrequest.parse = {\n  'application/x-www-form-urlencoded': parseString,\n  'application/json': JSON.parse\n};\n\n/**\n * Parse the given header `str` into\n * an object containing the mapped fields.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction parseHeader(str) {\n  var lines = str.split(/\\r?\\n/);\n  var fields = {};\n  var index;\n  var line;\n  var field;\n  var val;\n\n  lines.pop(); // trailing CRLF\n\n  for (var i = 0, len = lines.length; i < len; ++i) {\n    line = lines[i];\n    index = line.indexOf(':');\n    field = line.slice(0, index).toLowerCase();\n    val = trim(line.slice(index + 1));\n    fields[field] = val;\n  }\n\n  return fields;\n}\n\n/**\n * Check if `mime` is json or has +json structured syntax suffix.\n *\n * @param {String} mime\n * @return {Boolean}\n * @api private\n */\n\nfunction isJSON(mime) {\n  return /[\\/+]json\\b/.test(mime);\n}\n\n/**\n * Return the mime type for the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nfunction type(str){\n  return str.split(/ *; */).shift();\n};\n\n/**\n * Return header field parameters.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction params(str){\n  return reduce(str.split(/ *; */), function(obj, str){\n    var parts = str.split(/ *= */)\n      , key = parts.shift()\n      , val = parts.shift();\n\n    if (key && val) obj[key] = val;\n    return obj;\n  }, {});\n};\n\n/**\n * Initialize a new `Response` with the given `xhr`.\n *\n *  - set flags (.ok, .error, etc)\n *  - parse header\n *\n * Examples:\n *\n *  Aliasing `superagent` as `request` is nice:\n *\n *      request = superagent;\n *\n *  We can use the promise-like API, or pass callbacks:\n *\n *      request.get('/').end(function(res){});\n *      request.get('/', function(res){});\n *\n *  Sending data can be chained:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' })\n *        .end(function(res){});\n *\n *  Or passed to `.send()`:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' }, function(res){});\n *\n *  Or passed to `.post()`:\n *\n *      request\n *        .post('/user', { name: 'tj' })\n *        .end(function(res){});\n *\n * Or further reduced to a single call for simple cases:\n *\n *      request\n *        .post('/user', { name: 'tj' }, function(res){});\n *\n * @param {XMLHTTPRequest} xhr\n * @param {Object} options\n * @api private\n */\n\nfunction Response(req, options) {\n  options = options || {};\n  this.req = req;\n  this.xhr = this.req.xhr;\n  // responseText is accessible only if responseType is '' or 'text' and on older browsers\n  this.text = ((this.req.method !='HEAD' && (this.xhr.responseType === '' || this.xhr.responseType === 'text')) || typeof this.xhr.responseType === 'undefined')\n     ? this.xhr.responseText\n     : null;\n  this.statusText = this.req.xhr.statusText;\n  this.setStatusProperties(this.xhr.status);\n  this.header = this.headers = parseHeader(this.xhr.getAllResponseHeaders());\n  // getAllResponseHeaders sometimes falsely returns \"\" for CORS requests, but\n  // getResponseHeader still works. so we get content-type even if getting\n  // other headers fails.\n  this.header['content-type'] = this.xhr.getResponseHeader('content-type');\n  this.setHeaderProperties(this.header);\n  this.body = this.req.method != 'HEAD'\n    ? this.parseBody(this.text ? this.text : this.xhr.response)\n    : null;\n}\n\n/**\n * Get case-insensitive `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api public\n */\n\nResponse.prototype.get = function(field){\n  return this.header[field.toLowerCase()];\n};\n\n/**\n * Set header related properties:\n *\n *   - `.type` the content type without params\n *\n * A response of \"Content-Type: text/plain; charset=utf-8\"\n * will provide you with a `.type` of \"text/plain\".\n *\n * @param {Object} header\n * @api private\n */\n\nResponse.prototype.setHeaderProperties = function(header){\n  // content-type\n  var ct = this.header['content-type'] || '';\n  this.type = type(ct);\n\n  // params\n  var obj = params(ct);\n  for (var key in obj) this[key] = obj[key];\n};\n\n/**\n * Parse the given body `str`.\n *\n * Used for auto-parsing of bodies. Parsers\n * are defined on the `superagent.parse` object.\n *\n * @param {String} str\n * @return {Mixed}\n * @api private\n */\n\nResponse.prototype.parseBody = function(str){\n  var parse = request.parse[this.type];\n  return parse && str && (str.length || str instanceof Object)\n    ? parse(str)\n    : null;\n};\n\n/**\n * Set flags such as `.ok` based on `status`.\n *\n * For example a 2xx response will give you a `.ok` of __true__\n * whereas 5xx will be __false__ and `.error` will be __true__. The\n * `.clientError` and `.serverError` are also available to be more\n * specific, and `.statusType` is the class of error ranging from 1..5\n * sometimes useful for mapping respond colors etc.\n *\n * \"sugar\" properties are also defined for common cases. Currently providing:\n *\n *   - .noContent\n *   - .badRequest\n *   - .unauthorized\n *   - .notAcceptable\n *   - .notFound\n *\n * @param {Number} status\n * @api private\n */\n\nResponse.prototype.setStatusProperties = function(status){\n  // handle IE9 bug: http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n  if (status === 1223) {\n    status = 204;\n  }\n\n  var type = status / 100 | 0;\n\n  // status / class\n  this.status = this.statusCode = status;\n  this.statusType = type;\n\n  // basics\n  this.info = 1 == type;\n  this.ok = 2 == type;\n  this.clientError = 4 == type;\n  this.serverError = 5 == type;\n  this.error = (4 == type || 5 == type)\n    ? this.toError()\n    : false;\n\n  // sugar\n  this.accepted = 202 == status;\n  this.noContent = 204 == status;\n  this.badRequest = 400 == status;\n  this.unauthorized = 401 == status;\n  this.notAcceptable = 406 == status;\n  this.notFound = 404 == status;\n  this.forbidden = 403 == status;\n};\n\n/**\n * Return an `Error` representative of this response.\n *\n * @return {Error}\n * @api public\n */\n\nResponse.prototype.toError = function(){\n  var req = this.req;\n  var method = req.method;\n  var url = req.url;\n\n  var msg = 'cannot ' + method + ' ' + url + ' (' + this.status + ')';\n  var err = new Error(msg);\n  err.status = this.status;\n  err.method = method;\n  err.url = url;\n\n  return err;\n};\n\n/**\n * Expose `Response`.\n */\n\nrequest.Response = Response;\n\n/**\n * Initialize a new `Request` with the given `method` and `url`.\n *\n * @param {String} method\n * @param {String} url\n * @api public\n */\n\nfunction Request(method, url) {\n  var self = this;\n  Emitter.call(this);\n  this._query = this._query || [];\n  this.method = method;\n  this.url = url;\n  this.header = {};\n  this._header = {};\n  this.on('end', function(){\n    var err = null;\n    var res = null;\n\n    try {\n      res = new Response(self);\n    } catch(e) {\n      err = new Error('Parser is unable to parse the response');\n      err.parse = true;\n      err.original = e;\n      // issue #675: return the raw response if the response parsing fails\n      err.rawResponse = self.xhr && self.xhr.responseText ? self.xhr.responseText : null;\n      return self.callback(err);\n    }\n\n    self.emit('response', res);\n\n    if (err) {\n      return self.callback(err, res);\n    }\n\n    if (res.status >= 200 && res.status < 300) {\n      return self.callback(err, res);\n    }\n\n    var new_err = new Error(res.statusText || 'Unsuccessful HTTP response');\n    new_err.original = err;\n    new_err.response = res;\n    new_err.status = res.status;\n\n    self.callback(new_err, res);\n  });\n}\n\n/**\n * Mixin `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Allow for extension\n */\n\nRequest.prototype.use = function(fn) {\n  fn(this);\n  return this;\n}\n\n/**\n * Set timeout to `ms`.\n *\n * @param {Number} ms\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.timeout = function(ms){\n  this._timeout = ms;\n  return this;\n};\n\n/**\n * Clear previous timeout.\n *\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.clearTimeout = function(){\n  this._timeout = 0;\n  clearTimeout(this._timer);\n  return this;\n};\n\n/**\n * Abort the request, and clear potential timeout.\n *\n * @return {Request}\n * @api public\n */\n\nRequest.prototype.abort = function(){\n  if (this.aborted) return;\n  this.aborted = true;\n  this.xhr.abort();\n  this.clearTimeout();\n  this.emit('abort');\n  return this;\n};\n\n/**\n * Set header `field` to `val`, or multiple fields with one object.\n *\n * Examples:\n *\n *      req.get('/')\n *        .set('Accept', 'application/json')\n *        .set('X-API-Key', 'foobar')\n *        .end(callback);\n *\n *      req.get('/')\n *        .set({ Accept: 'application/json', 'X-API-Key': 'foobar' })\n *        .end(callback);\n *\n * @param {String|Object} field\n * @param {String} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.set = function(field, val){\n  if (isObject(field)) {\n    for (var key in field) {\n      this.set(key, field[key]);\n    }\n    return this;\n  }\n  this._header[field.toLowerCase()] = val;\n  this.header[field] = val;\n  return this;\n};\n\n/**\n * Remove header `field`.\n *\n * Example:\n *\n *      req.get('/')\n *        .unset('User-Agent')\n *        .end(callback);\n *\n * @param {String} field\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.unset = function(field){\n  delete this._header[field.toLowerCase()];\n  delete this.header[field];\n  return this;\n};\n\n/**\n * Get case-insensitive header `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api private\n */\n\nRequest.prototype.getHeader = function(field){\n  return this._header[field.toLowerCase()];\n};\n\n/**\n * Set Content-Type to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.xml = 'application/xml';\n *\n *      request.post('/')\n *        .type('xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n *      request.post('/')\n *        .type('application/xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n * @param {String} type\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.type = function(type){\n  this.set('Content-Type', request.types[type] || type);\n  return this;\n};\n\n/**\n * Force given parser\n *\n * Sets the body parser no matter type.\n *\n * @param {Function}\n * @api public\n */\n\nRequest.prototype.parse = function(fn){\n  this._parser = fn;\n  return this;\n};\n\n/**\n * Set Accept to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.json = 'application/json';\n *\n *      request.get('/agent')\n *        .accept('json')\n *        .end(callback);\n *\n *      request.get('/agent')\n *        .accept('application/json')\n *        .end(callback);\n *\n * @param {String} accept\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.accept = function(type){\n  this.set('Accept', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Authorization field value with `user` and `pass`.\n *\n * @param {String} user\n * @param {String} pass\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.auth = function(user, pass){\n  var str = btoa(user + ':' + pass);\n  this.set('Authorization', 'Basic ' + str);\n  return this;\n};\n\n/**\n* Add query-string `val`.\n*\n* Examples:\n*\n*   request.get('/shoes')\n*     .query('size=10')\n*     .query({ color: 'blue' })\n*\n* @param {Object|String} val\n* @return {Request} for chaining\n* @api public\n*/\n\nRequest.prototype.query = function(val){\n  if ('string' != typeof val) val = serialize(val);\n  if (val) this._query.push(val);\n  return this;\n};\n\n/**\n * Write the field `name` and `val` for \"multipart/form-data\"\n * request bodies.\n *\n * ``` js\n * request.post('/upload')\n *   .field('foo', 'bar')\n *   .end(callback);\n * ```\n *\n * @param {String} name\n * @param {String|Blob|File} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.field = function(name, val){\n  if (!this._formData) this._formData = new root.FormData();\n  this._formData.append(name, val);\n  return this;\n};\n\n/**\n * Queue the given `file` as an attachment to the specified `field`,\n * with optional `filename`.\n *\n * ``` js\n * request.post('/upload')\n *   .attach(new Blob(['<a id=\"a\"><b id=\"b\">hey!</b></a>'], { type: \"text/html\"}))\n *   .end(callback);\n * ```\n *\n * @param {String} field\n * @param {Blob|File} file\n * @param {String} filename\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.attach = function(field, file, filename){\n  if (!this._formData) this._formData = new root.FormData();\n  this._formData.append(field, file, filename);\n  return this;\n};\n\n/**\n * Send `data`, defaulting the `.type()` to \"json\" when\n * an object is given.\n *\n * Examples:\n *\n *       // querystring\n *       request.get('/search')\n *         .end(callback)\n *\n *       // multiple data \"writes\"\n *       request.get('/search')\n *         .send({ search: 'query' })\n *         .send({ range: '1..5' })\n *         .send({ order: 'desc' })\n *         .end(callback)\n *\n *       // manual json\n *       request.post('/user')\n *         .type('json')\n *         .send('{\"name\":\"tj\"}')\n *         .end(callback)\n *\n *       // auto json\n *       request.post('/user')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // manual x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send('name=tj')\n *         .end(callback)\n *\n *       // auto x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // defaults to x-www-form-urlencoded\n  *      request.post('/user')\n  *        .send('name=tobi')\n  *        .send('species=ferret')\n  *        .end(callback)\n *\n * @param {String|Object} data\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.send = function(data){\n  var obj = isObject(data);\n  var type = this.getHeader('Content-Type');\n\n  // merge\n  if (obj && isObject(this._data)) {\n    for (var key in data) {\n      this._data[key] = data[key];\n    }\n  } else if ('string' == typeof data) {\n    if (!type) this.type('form');\n    type = this.getHeader('Content-Type');\n    if ('application/x-www-form-urlencoded' == type) {\n      this._data = this._data\n        ? this._data + '&' + data\n        : data;\n    } else {\n      this._data = (this._data || '') + data;\n    }\n  } else {\n    this._data = data;\n  }\n\n  if (!obj || isHost(data)) return this;\n  if (!type) this.type('json');\n  return this;\n};\n\n/**\n * Invoke the callback with `err` and `res`\n * and handle arity check.\n *\n * @param {Error} err\n * @param {Response} res\n * @api private\n */\n\nRequest.prototype.callback = function(err, res){\n  var fn = this._callback;\n  this.clearTimeout();\n  fn(err, res);\n};\n\n/**\n * Invoke callback with x-domain error.\n *\n * @api private\n */\n\nRequest.prototype.crossDomainError = function(){\n  var err = new Error('Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.');\n  err.crossDomain = true;\n\n  err.status = this.status;\n  err.method = this.method;\n  err.url = this.url;\n\n  this.callback(err);\n};\n\n/**\n * Invoke callback with timeout error.\n *\n * @api private\n */\n\nRequest.prototype.timeoutError = function(){\n  var timeout = this._timeout;\n  var err = new Error('timeout of ' + timeout + 'ms exceeded');\n  err.timeout = timeout;\n  this.callback(err);\n};\n\n/**\n * Enable transmission of cookies with x-domain requests.\n *\n * Note that for this to work the origin must not be\n * using \"Access-Control-Allow-Origin\" with a wildcard,\n * and also must set \"Access-Control-Allow-Credentials\"\n * to \"true\".\n *\n * @api public\n */\n\nRequest.prototype.withCredentials = function(){\n  this._withCredentials = true;\n  return this;\n};\n\n/**\n * Initiate request, invoking callback `fn(res)`\n * with an instanceof `Response`.\n *\n * @param {Function} fn\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.end = function(fn){\n  var self = this;\n  var xhr = this.xhr = request.getXHR();\n  var query = this._query.join('&');\n  var timeout = this._timeout;\n  var data = this._formData || this._data;\n\n  // store callback\n  this._callback = fn || noop;\n\n  // state change\n  xhr.onreadystatechange = function(){\n    if (4 != xhr.readyState) return;\n\n    // In IE9, reads to any property (e.g. status) off of an aborted XHR will\n    // result in the error \"Could not complete the operation due to error c00c023f\"\n    var status;\n    try { status = xhr.status } catch(e) { status = 0; }\n\n    if (0 == status) {\n      if (self.timedout) return self.timeoutError();\n      if (self.aborted) return;\n      return self.crossDomainError();\n    }\n    self.emit('end');\n  };\n\n  // progress\n  var handleProgress = function(e){\n    if (e.total > 0) {\n      e.percent = e.loaded / e.total * 100;\n    }\n    self.emit('progress', e);\n  };\n  if (this.hasListeners('progress')) {\n    xhr.onprogress = handleProgress;\n  }\n  try {\n    if (xhr.upload && this.hasListeners('progress')) {\n      xhr.upload.onprogress = handleProgress;\n    }\n  } catch(e) {\n    // Accessing xhr.upload fails in IE from a web worker, so just pretend it doesn't exist.\n    // Reported here:\n    // https://connect.microsoft.com/IE/feedback/details/837245/xmlhttprequest-upload-throws-invalid-argument-when-used-from-web-worker-context\n  }\n\n  // timeout\n  if (timeout && !this._timer) {\n    this._timer = setTimeout(function(){\n      self.timedout = true;\n      self.abort();\n    }, timeout);\n  }\n\n  // querystring\n  if (query) {\n    query = request.serializeObject(query);\n    this.url += ~this.url.indexOf('?')\n      ? '&' + query\n      : '?' + query;\n  }\n\n  // initiate request\n  xhr.open(this.method, this.url, true);\n\n  // CORS\n  if (this._withCredentials) xhr.withCredentials = true;\n\n  // body\n  if ('GET' != this.method && 'HEAD' != this.method && 'string' != typeof data && !isHost(data)) {\n    // serialize stuff\n    var contentType = this.getHeader('Content-Type');\n    var serialize = this._parser || request.serialize[contentType ? contentType.split(';')[0] : ''];\n    if (!serialize && isJSON(contentType)) serialize = request.serialize['application/json'];\n    if (serialize) data = serialize(data);\n  }\n\n  // set header fields\n  for (var field in this.header) {\n    if (null == this.header[field]) continue;\n    xhr.setRequestHeader(field, this.header[field]);\n  }\n\n  // send stuff\n  this.emit('request', this);\n\n  // IE11 xhr.send(undefined) sends 'undefined' string as POST payload (instead of nothing)\n  // We need null here if data is undefined\n  xhr.send(typeof data !== 'undefined' ? data : null);\n  return this;\n};\n\n/**\n * Faux promise support\n *\n * @param {Function} fulfill\n * @param {Function} reject\n * @return {Request}\n */\n\nRequest.prototype.then = function (fulfill, reject) {\n  return this.end(function(err, res) {\n    err ? reject(err) : fulfill(res);\n  });\n}\n\n/**\n * Expose `Request`.\n */\n\nrequest.Request = Request;\n\n/**\n * Issue a request:\n *\n * Examples:\n *\n *    request('GET', '/users').end(callback)\n *    request('/users').end(callback)\n *    request('/users', callback)\n *\n * @param {String} method\n * @param {String|Function} url or callback\n * @return {Request}\n * @api public\n */\n\nfunction request(method, url) {\n  // callback\n  if ('function' == typeof url) {\n    return new Request('GET', method).end(url);\n  }\n\n  // url first\n  if (1 == arguments.length) {\n    return new Request('GET', method);\n  }\n\n  return new Request(method, url);\n}\n\n/**\n * GET `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.get = function(url, data, fn){\n  var req = request('GET', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.query(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * HEAD `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.head = function(url, data, fn){\n  var req = request('HEAD', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * DELETE `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nfunction del(url, fn){\n  var req = request('DELETE', url);\n  if (fn) req.end(fn);\n  return req;\n};\n\nrequest.del = del;\nrequest.delete = del;\n\n/**\n * PATCH `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.patch = function(url, data, fn){\n  var req = request('PATCH', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * POST `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.post = function(url, data, fn){\n  var req = request('POST', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * PUT `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.put = function(url, data, fn){\n  var req = request('PUT', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * Expose `request`.\n */\n\nmodule.exports = request;\n","/* global localStorage */\r\nvar Table = require('./table');\r\n\r\nmodule.exports = class Database {\r\n  constructor (name, options) {\r\n    this.url = name || '/api/';\r\n    if (!this.url.match(/\\/$/)) {\r\n      this.url += '/';\r\n    }\r\n\r\n    options = options | {};\r\n    this.cacheTTL = options.cacheTTL || 10 * 60 * 1000; // 10 minutes\r\n    this.cacheByDefault = options.cacheByDefault || false;\r\n    this.storage = options.storage || localStorage;\r\n    this.plugins = options.plugins || [];\r\n\r\n    var self = this;\r\n    var _database = function (table) {\r\n      return new Table(self, table);\r\n    };\r\n    // `public` functions\r\n    this.plugins.forEach(plugin => {\r\n      plugin.call(self);\r\n    });\r\n\r\n    return _database;\r\n  }\r\n};\r\n","// The Export Module\r\nglobal.Unrest = require('./database');\r\nglobal.Unrest.superagent = require('superagent');\r\n\r\nmodule.exports = global.Unrest;\r\n","var xhr = require('superagent');\r\n\r\nfunction jsonify (agent) {\r\n  return agent.type('application/json')\r\n    .accept('json');\r\n}\r\n\r\nfunction handleResponses (request) {\r\n  request._status = 'pending';\r\n  var method = request._agent.method;\r\n  var url = request._agent.url;\r\n  const CACHE_KEY = 'unrest-' + method + '-' + url;\r\n  var storageProvider = request._table._database.storage;\r\n\r\n  // //\r\n  // Perform Cache\r\n  if (request._cache) {\r\n    var cache = JSON.parse(storageProvider.getItem(CACHE_KEY));\r\n\r\n    if (cache) {\r\n      // if the cache exists and isn't old\r\n      if (cache.time && request._cache > +(new Date()) - cache.time) {\r\n        request._onSuccess.forEach(function (cb) {\r\n          cb(cache.data, true);\r\n        });\r\n        request._cachedata = cache.data;\r\n      } else {\r\n        storageProvider.removeItem(CACHE_KEY);\r\n      }\r\n    }\r\n  }\r\n\r\n  // //\r\n  // Handle Response\r\n  request._agent.end(function (err, res) {\r\n    request._status = 'resolved';\r\n    if (err) { // on error\r\n      request.error = err;\r\n      request._onError.forEach(function (cb) {\r\n        cb(err);\r\n      });\r\n    } else { // on success\r\n      request._data = res.body;\r\n      if (request._cache) {\r\n        storageProvider.setItem(CACHE_KEY, JSON.stringify(\r\n          { time: +new Date(), data: request._data }\r\n        ));\r\n      }\r\n      // //\r\n      // perform injection\r\n      if (typeof (res.body) === 'object' && !Array.isArray(res.body)) {\r\n        for (var prop in request._data) {\r\n          request[prop] = request._data[prop];\r\n        }\r\n      } else {\r\n        request.data = request._data;\r\n      }\r\n      // //\r\n      // perform calbacks.\r\n      request._onSuccess.forEach(function (cb) {\r\n        cb(res.body);\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nmodule.exports = class Request {\r\n  constructor (table) {\r\n    this._table = table;\r\n    this._status = 'idle';\r\n    this._onSuccess = [];\r\n    this._onError = [];\r\n    if (this._table._database.cacheByDefault) {\r\n      this._cache = this._table._database.cacheTTL;\r\n    }\r\n  }\r\n\r\n  cacheable (lifetime) {\r\n    if (this._status !== 'idle' && this._status !== 'pending') {\r\n      console.error('cacheable could not be set before request was sent out. Ensure this is called before query, fetch, save, then, etc');\r\n    }\r\n    if (!lifetime) {\r\n      lifetime = this._table._database.cacheTTL;\r\n    }\r\n    this._cache = lifetime;\r\n    return this;\r\n  }\r\n\r\n  // QUERY GET /table/\r\n  // Returns a list.\r\n  query (options) {\r\n    this._agent = xhr\r\n      .get(this._table.url)\r\n      .query(options);\r\n    jsonify(this._agent);\r\n    if (this._status === 'idle') handleResponses(this);\r\n    return this;\r\n  }\r\n\r\n  fetch (id, options) {\r\n    this._agent = xhr\r\n      .get(this._table.url + '/' + id.toString())\r\n      .query(options);\r\n    jsonify(this._agent);\r\n    if (this._status === 'idle') handleResponses(this);\r\n    return this;\r\n  }\r\n\r\n  save (obj) {\r\n    var r = null;\r\n    var id = obj.Id || obj.id;\r\n    if (!id || id === 0) {\r\n      r = xhr.post(this._table.url);\r\n    } else {\r\n      r = xhr.put(`${this._table.url}/${id}`);\r\n    }\r\n    this._agent = r.send(obj);\r\n    jsonify(this._agent);\r\n    if (this._status === 'idle') handleResponses(this);\r\n    return this;\r\n  }\r\n\r\n  remove (Id) {\r\n    this._agent = xhr.del(this._table.url + '/' + Id);\r\n    jsonify(this._agent);\r\n    return this;\r\n  }\r\n\r\n  then (cb) {\r\n    if (this._status === 'resolved' && !this.error) {\r\n      cb(this._data);\r\n    } else {\r\n      this._onSuccess.push(cb);\r\n    }\r\n    if (this._status === 'idle') handleResponses(this);\r\n    if (this._status === 'pending' && this._cachedata) {\r\n      cb(this._cachedata, true);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  catch (cb) {\r\n    if (this._status === 'resolved' && this.error) {\r\n      cb(this.error);\r\n    } else {\r\n      this._onError.push(cb);\r\n    }\r\n    if (this._status === 'idle') handleResponses(this);\r\n    return this;\r\n  }\r\n\r\n  status () {\r\n    return this._status;\r\n  }\r\n};\r\n","var Request = require('./request');\r\n\r\nmodule.exports = class Table {\r\n    constructor (database, table) {\r\n      this._database = database;\r\n      this.url = database.url + table;\r\n      this.name = table;\r\n      this.events = {};\r\n    }\r\n\r\n    query (options) {\r\n      return new Request(this).query(options);\r\n    }\r\n\r\n    fetch (id) {\r\n      return new Request(this).fetch(id);\r\n    }\r\n\r\n    save (object) {\r\n      return new Request(this).save(object);\r\n    }\r\n\r\n    remove (obj) {\r\n      return new Request(this).remove(obj);\r\n    }\r\n\r\n    cacheable (obj) {\r\n      return new Request(this).cacheable(obj);\r\n    }\r\n};\r\n"],"sourceRoot":"/source/"}