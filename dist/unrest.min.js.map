{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/component-emitter/index.js","unrest.min.js","node_modules/odata-filter-parser/dist/odata-parser.js","node_modules/odata-filter-parser/index.js","node_modules/reduce-component/index.js","node_modules/superagent/lib/client.js","src/database.js","src/src/main.js","src/odata.js","src/query.js","src/request.js","src/table.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","Emitter","obj","mixin","key","prototype","on","addEventListener","event","fn","this","_callbacks","push","once","self","off","apply","arguments","removeListener","removeAllListeners","removeEventListener","callbacks","cb","splice","emit","args","slice","len","listeners","hasListeners",2,"Operators","EQUALS","AND","OR","GREATER_THAN","GREATER_THAN_EQUAL","LESS_THAN","LESS_THAN_EQUAL","LIKE","IS_NULL","NOT_EQUAL","isUnary","op","value","isLogical","Predicate","config","subject","operator","concat","p","Array","msg","result","arr","j","flatten","serialize","retValue","undefined","val","Date","source","toISOString","ODataParser","buildLike","match","right","charAt","lastIndexOf","parseFragment","filter","found","REGEX","regex","parenthesis","indexOf","andor","m","startsWith","endsWith","contains","parse","filterStr","trim","Parser",3,"./dist/odata-parser",4,"initial","idx","curr",5,"noop","isHost","str","toString","isObject","Object","pairs","pushEncodedKeyValuePair","join","isArray","forEach","v","encodeURIComponent","parseString","parts","pair","split","decodeURIComponent","parseHeader","index","line","field","lines","fields","pop","toLowerCase","isJSON","mime","test","type","shift","params","reduce","Response","req","options","xhr","text","method","responseType","responseText","statusText","setStatusProperties","status","header","headers","getAllResponseHeaders","getResponseHeader","setHeaderProperties","body","parseBody","response","Request","url","_query","_header","err","res","original","rawResponse","callback","new_err","request","end","del","root","window","getXHR","XMLHttpRequest","location","protocol","ActiveXObject","replace","serializeObject","types","html","json","xml","urlencoded","form","form-data","application/x-www-form-urlencoded","application/json","JSON","stringify","get","ct","statusCode","statusType","info","ok","clientError","serverError","error","toError","accepted","noContent","badRequest","unauthorized","notAcceptable","notFound","forbidden","use","timeout","ms","_timeout","clearTimeout","_timer","abort","aborted","set","unset","getHeader","_parser","accept","auth","user","pass","btoa","query","name","_formData","FormData","append","attach","file","filename","send","data","_data","_callback","crossDomainError","crossDomain","timeoutError","withCredentials","_withCredentials","onreadystatechange","readyState","timedout","handleProgress","total","percent","loaded","onprogress","upload","setTimeout","open","contentType","setRequestHeader","then","fulfill","reject","head","patch","post","put","emitter",6,"_classCallCheck","instance","Constructor","TypeError","Table","Database","odata","cacheTTL","cacheByDefault","storage","localStorage","plugins","onEnd","_database","table","plugin","./table",7,"global","Unrest","superagent","./database",8,"_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","parser","Odata","g","q","console","log","order","b","substring","skip","parseInt","take","where","select","odata-filter-parser",9,"Query","_this","_len","_key","arg","_this2","_len2","_key2","pred","amount",10,"_typeof","Symbol","constructor","jsonify","agent","handleResponses","_status","pending","_agent","CACHE_KEY","storageProvider","_table","_cache","cache","getItem","time","_onSuccess","_cachedata","removeItem","_onError","setItem","prop","lifetime","id","resource","Id","./odata",11,"_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","_Query","database","getPrototypeOf","events","fetch","object","save","remove","cacheable","./query","./request"],"mappings":"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","file":"unrest.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\n/**\n * Expose `Emitter`.\n */\n\nmodule.exports = Emitter;\n\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n};\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks[event] = this._callbacks[event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  var self = this;\n  this._callbacks = this._callbacks || {};\n\n  function on() {\n    self.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks[event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks[event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n  var args = [].slice.call(arguments, 1)\n    , callbacks = this._callbacks[event];\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks[event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\n/**\n * Expose `Emitter`.\n */\n\nmodule.exports = Emitter;\n\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n};\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks[event] = this._callbacks[event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  var self = this;\n  this._callbacks = this._callbacks || {};\n\n  function on() {\n    self.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks[event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks[event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n  var args = [].slice.call(arguments, 1)\n    , callbacks = this._callbacks[event];\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks[event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n\n},{}],2:[function(require,module,exports){\n/**\r\n Copyright 2015 Jason Drake\r\n\r\n Licensed under the Apache License, Version 2.0 (the \"License\");\r\n you may not use this file except in compliance with the License.\r\n You may obtain a copy of the License at\r\n\r\n http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n Unless required by applicable law or agreed to in writing, software\r\n distributed under the License is distributed on an \"AS IS\" BASIS,\r\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n See the License for the specific language governing permissions and\r\n limitations under the License.\r\n */\r\n\r\nvar Operators = {\r\n    EQUALS: 'eq',\r\n    AND: 'and',\r\n    OR: 'or',\r\n    GREATER_THAN: 'gt',\r\n    GREATER_THAN_EQUAL: 'ge',\r\n    LESS_THAN: 'lt',\r\n    LESS_THAN_EQUAL: 'le',\r\n    LIKE: 'like',\r\n    IS_NULL: 'is null',\r\n    NOT_EQUAL: 'ne',\r\n\r\n    /**\r\n     * Whether a defined operation is unary or binary.  Will return true\r\n     * if the operation only supports a subject with no value.\r\n     *\r\n     * @param {String} op the operation to check.\r\n     * @return {Boolean} whether the operation is an unary operation.\r\n     */\r\n    isUnary: function (op) {\r\n        var value = false;\r\n        if (op === Operators.IS_NULL) {\r\n            value = true;\r\n        }\r\n        return value;\r\n    },\r\n    /**\r\n     * Whether a defined operation is a logical operators or not.\r\n     *\r\n     * @param {String} op the operation to check.\r\n     * @return {Boolean} whether the operation is a logical operation.\r\n     */\r\n    isLogical: function (op) {\r\n        return (op === Operators.AND || op === Operators.OR);\r\n    }\r\n};\r\n\r\n/**\r\n * Predicate is the basic model construct of the odata expression\r\n *\r\n * @param config\r\n * @returns {Predicate}\r\n * @constructor\r\n */\r\nvar Predicate = function (config) {\r\n    if (!config) {\r\n        config = {};\r\n    }\r\n    this.subject = config.subject;\r\n    this.value = config.value;\r\n    this.operator = (config.operator) ? config.operator : Operators.EQUALS;\r\n    return this;\r\n};\r\n\r\nPredicate.concat = function (operator, p) {\r\n    if (arguments.length < 3 && !(p instanceof Array && p.length >= 2)) {\r\n        throw {\r\n            key: 'INSUFFICIENT_PREDICATES',\r\n            msg: 'At least two predicates are required'\r\n        };\r\n    } else if (!operator || !Operators.isLogical(operator)) {\r\n        throw {\r\n            key: 'INVALID_LOGICAL',\r\n            msg: 'The operator is not representative of a logical operator.'\r\n        };\r\n    }\r\n    var result;\r\n    var arr = [];\r\n    if( p instanceof Array ) {\r\n        arr = p;\r\n    } else {\r\n        for( var i = 1; i < arguments.length; i++ ) {\r\n            arr.push( arguments[i] );\r\n        }\r\n    }\r\n    var len = arr.length;\r\n    result = new Predicate({\r\n        subject: arr[0],\r\n        operator: operator\r\n    });\r\n    if (len === 2) {\r\n        result.value = arr[len - 1];\r\n    } else {\r\n        var a = [];\r\n        for( var j = 1; j < len; j++ ) {\r\n            a.push(arr[j]);\r\n        }\r\n        result.value = Predicate.concat(operator, a);\r\n    }\r\n    return result;\r\n};\r\n\r\nPredicate.prototype.flatten = function(result) {\r\n    if( !result ) {\r\n        result = [];\r\n    }\r\n    if( Operators.isLogical(this.operator) ) {\r\n        result = result.concat(this.subject.flatten());\r\n        result = result.concat(this.value.flatten());\r\n    } else {\r\n        result.push(this);\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Will serialie the predicate to an ODATA compliant serialized string.\r\n *\r\n * @return {String} The compliant ODATA query string\r\n */\r\nPredicate.prototype.serialize = function() {\r\n    var retValue = '';\r\n    if (this.operator) {\r\n        if (this.subject === undefined || this.subject === null) {\r\n            throw {\r\n                key: 'INVALID_SUBJECT',\r\n                msg: 'The subject is required and is not specified.'\r\n            };\r\n        }\r\n        if (Operators.isLogical(this.operator) && (!(this.subject instanceof Predicate ||\r\n            this.value instanceof Predicate) || (this.subject instanceof Predicate && this.value === undefined))) {\r\n            throw {\r\n                key: 'INVALID_LOGICAL',\r\n                msg: 'The predicate does not represent a valid logical expression.'\r\n            };\r\n        }\r\n        retValue = '(' + ((this.subject instanceof Predicate) ? this.subject.serialize() : this.subject) + ' ' + this.operator;\r\n        if (!Operators.isUnary(this.operator)) {\r\n            if (this.value === undefined || this.value === null) {\r\n                throw {\r\n                    key: 'INVALID_VALUE',\r\n                    msg: 'The value was required but was not defined.'\r\n                };\r\n            }\r\n            retValue += ' ';\r\n            var val = typeof this.value;\r\n            if (val === 'string') {\r\n                retValue += '\\'' + this.value + '\\'';\r\n            } else if (val === 'number' || val === 'boolean') {\r\n                retValue += this.value;\r\n            } else if (this.value instanceof Predicate) {\r\n                retValue += this.value.serialize();\r\n            } else if (this.value instanceof Date) {\r\n                retValue += 'datetimeoffset\\'' + this.value.toISOString() + '\\'';\r\n            } else {\r\n                throw {\r\n                    key: 'UNKNOWN_TYPE',\r\n                    msg: 'Unsupported value type: ' + (typeof this.value),\r\n                    source: this.value\r\n                };\r\n            }\r\n\r\n        }\r\n        retValue += ')';\r\n    }\r\n    return retValue;\r\n};\r\n\r\nvar ODataParser = function() {\r\n\r\n    \"use strict\";\r\n\r\n    var REGEX = {\r\n        parenthesis: /^([(](.*)[)])$/,\r\n        andor: /^(.*?) (or|and)+ (.*)$/,\r\n        op: /(\\w*) (eq|gt|lt|ge|le|ne) (datetimeoffset'(.*)'|'(.*)'|[0-9]*)/,\r\n        startsWith: /^startswith[(](.*),'(.*)'[)]/,\r\n        endsWith: /^endswith[(](.*),'(.*)'[)]/,\r\n        contains: /^contains[(](.*),'(.*)'[)]/\r\n    };\r\n\r\n    function buildLike(match, key) {\r\n        var right = (key === 'startsWith') ? match[2] + '*' : (key === 'endsWith') ? '*' + match[2] : '*' + match[2] + '*';\r\n        if( match[0].charAt(match[0].lastIndexOf(')') - 1) === \"\\'\") {\r\n            right = \"\\'\" + right + \"\\'\";\r\n        }\r\n        return {\r\n            subject: match[1],\r\n            operator: Operators.LIKE,\r\n            value: right\r\n        };\r\n    }\r\n\r\n    function parseFragment(filter) {\r\n        var found = false;\r\n        var obj = null;\r\n        for (var key in REGEX ) {\r\n            var regex = REGEX[key];\r\n            if( found ) {\r\n                break;\r\n            }\r\n            var match = filter.match(regex);\r\n            if( match ) {\r\n                switch (regex) {\r\n                    case REGEX.parenthesis:\r\n                        if( match.length > 2 ) {\r\n                            if( match[2].indexOf(')') < match[2].indexOf('(')) {\r\n                                continue;\r\n                            }\r\n                            obj = parseFragment(match[2]);\r\n                        }\r\n                        break;\r\n                    case REGEX.andor:\r\n                        obj = new Predicate({\r\n                            subject: parseFragment(match[1]),\r\n                            operator: match[2],\r\n                            value: parseFragment(match[3])\r\n                        });\r\n                        break;\r\n                    case REGEX.op:\r\n                        obj = new Predicate({\r\n                            subject: match[1],\r\n                            operator: match[2],\r\n                            value: ( match[3].indexOf('\\'') === -1) ? +match[3] : match[3]\r\n                        });\r\n                        if(obj.value.indexOf && obj.value.indexOf(\"datetimeoffset\") === 0) {\r\n                            var m = obj.value.match(/^datetimeoffset'(.*)'$/);\r\n                            if( m && m.length > 1) {\r\n                                obj.value = new Date(m[1]);\r\n                            }\r\n                        }\r\n                        break;\r\n                    case REGEX.startsWith:\r\n                    case REGEX.endsWith:\r\n                    case REGEX.contains:\r\n                        obj = buildLike(match, key);\r\n                        break;\r\n                }\r\n                found = true;\r\n            }\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    return {\r\n        parse: function(filterStr) {\r\n            if( !filterStr || filterStr === '') {\r\n                return null;\r\n            }\r\n            var filter = filterStr.trim();\r\n            var obj = {};\r\n            if( filter.length > 0 ) {\r\n                obj = parseFragment(filter);\r\n            }\r\n            return obj;\r\n        }\r\n    };\r\n}();\r\n\r\n\r\n\r\nmodule.exports = {\r\n    Parser: ODataParser,\r\n    Operators: Operators,\r\n    Predicate: Predicate\r\n};\n},{}],3:[function(require,module,exports){\n/**\r\n Copyright 2015 Jason Drake\r\n\r\n Licensed under the Apache License, Version 2.0 (the \"License\");\r\n you may not use this file except in compliance with the License.\r\n You may obtain a copy of the License at\r\n\r\n http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n Unless required by applicable law or agreed to in writing, software\r\n distributed under the License is distributed on an \"AS IS\" BASIS,\r\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n See the License for the specific language governing permissions and\r\n limitations under the License.\r\n */\r\n\r\nmodule.exports = {\r\n    Predicate: require('./dist/odata-parser').Predicate,\r\n    Operators: require('./dist/odata-parser').Operators,\r\n    Parser: require('./dist/odata-parser').Parser\r\n}\n},{\"./dist/odata-parser\":2}],4:[function(require,module,exports){\n\n/**\n * Reduce `arr` with `fn`.\n *\n * @param {Array} arr\n * @param {Function} fn\n * @param {Mixed} initial\n *\n * TODO: combatible error handling?\n */\n\nmodule.exports = function(arr, fn, initial){  \n  var idx = 0;\n  var len = arr.length;\n  var curr = arguments.length == 3\n    ? initial\n    : arr[idx++];\n\n  while (idx < len) {\n    curr = fn.call(null, curr, arr[idx], ++idx, arr);\n  }\n  \n  return curr;\n};\n},{}],5:[function(require,module,exports){\n/**\n * Module dependencies.\n */\n\nvar Emitter = require('emitter');\nvar reduce = require('reduce');\n\n/**\n * Root reference for iframes.\n */\n\nvar root;\nif (typeof window !== 'undefined') { // Browser window\n  root = window;\n} else if (typeof self !== 'undefined') { // Web Worker\n  root = self;\n} else { // Other environments\n  root = this;\n}\n\n/**\n * Noop.\n */\n\nfunction noop(){};\n\n/**\n * Check if `obj` is a host object,\n * we don't want to serialize these :)\n *\n * TODO: future proof, move to compoent land\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isHost(obj) {\n  var str = {}.toString.call(obj);\n\n  switch (str) {\n    case '[object File]':\n    case '[object Blob]':\n    case '[object FormData]':\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Determine XHR.\n */\n\nrequest.getXHR = function () {\n  if (root.XMLHttpRequest\n      && (!root.location || 'file:' != root.location.protocol\n          || !root.ActiveXObject)) {\n    return new XMLHttpRequest;\n  } else {\n    try { return new ActiveXObject('Microsoft.XMLHTTP'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.6.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.3.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP'); } catch(e) {}\n  }\n  return false;\n};\n\n/**\n * Removes leading and trailing whitespace, added to support IE.\n *\n * @param {String} s\n * @return {String}\n * @api private\n */\n\nvar trim = ''.trim\n  ? function(s) { return s.trim(); }\n  : function(s) { return s.replace(/(^\\s*|\\s*$)/g, ''); };\n\n/**\n * Check if `obj` is an object.\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Serialize the given `obj`.\n *\n * @param {Object} obj\n * @return {String}\n * @api private\n */\n\nfunction serialize(obj) {\n  if (!isObject(obj)) return obj;\n  var pairs = [];\n  for (var key in obj) {\n    if (null != obj[key]) {\n      pushEncodedKeyValuePair(pairs, key, obj[key]);\n        }\n      }\n  return pairs.join('&');\n}\n\n/**\n * Helps 'serialize' with serializing arrays.\n * Mutates the pairs array.\n *\n * @param {Array} pairs\n * @param {String} key\n * @param {Mixed} val\n */\n\nfunction pushEncodedKeyValuePair(pairs, key, val) {\n  if (Array.isArray(val)) {\n    return val.forEach(function(v) {\n      pushEncodedKeyValuePair(pairs, key, v);\n    });\n  }\n  pairs.push(encodeURIComponent(key)\n    + '=' + encodeURIComponent(val));\n}\n\n/**\n * Expose serialization method.\n */\n\n request.serializeObject = serialize;\n\n /**\n  * Parse the given x-www-form-urlencoded `str`.\n  *\n  * @param {String} str\n  * @return {Object}\n  * @api private\n  */\n\nfunction parseString(str) {\n  var obj = {};\n  var pairs = str.split('&');\n  var parts;\n  var pair;\n\n  for (var i = 0, len = pairs.length; i < len; ++i) {\n    pair = pairs[i];\n    parts = pair.split('=');\n    obj[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);\n  }\n\n  return obj;\n}\n\n/**\n * Expose parser.\n */\n\nrequest.parseString = parseString;\n\n/**\n * Default MIME type map.\n *\n *     superagent.types.xml = 'application/xml';\n *\n */\n\nrequest.types = {\n  html: 'text/html',\n  json: 'application/json',\n  xml: 'application/xml',\n  urlencoded: 'application/x-www-form-urlencoded',\n  'form': 'application/x-www-form-urlencoded',\n  'form-data': 'application/x-www-form-urlencoded'\n};\n\n/**\n * Default serialization map.\n *\n *     superagent.serialize['application/xml'] = function(obj){\n *       return 'generated xml here';\n *     };\n *\n */\n\n request.serialize = {\n   'application/x-www-form-urlencoded': serialize,\n   'application/json': JSON.stringify\n };\n\n /**\n  * Default parsers.\n  *\n  *     superagent.parse['application/xml'] = function(str){\n  *       return { object parsed from str };\n  *     };\n  *\n  */\n\nrequest.parse = {\n  'application/x-www-form-urlencoded': parseString,\n  'application/json': JSON.parse\n};\n\n/**\n * Parse the given header `str` into\n * an object containing the mapped fields.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction parseHeader(str) {\n  var lines = str.split(/\\r?\\n/);\n  var fields = {};\n  var index;\n  var line;\n  var field;\n  var val;\n\n  lines.pop(); // trailing CRLF\n\n  for (var i = 0, len = lines.length; i < len; ++i) {\n    line = lines[i];\n    index = line.indexOf(':');\n    field = line.slice(0, index).toLowerCase();\n    val = trim(line.slice(index + 1));\n    fields[field] = val;\n  }\n\n  return fields;\n}\n\n/**\n * Check if `mime` is json or has +json structured syntax suffix.\n *\n * @param {String} mime\n * @return {Boolean}\n * @api private\n */\n\nfunction isJSON(mime) {\n  return /[\\/+]json\\b/.test(mime);\n}\n\n/**\n * Return the mime type for the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nfunction type(str){\n  return str.split(/ *; */).shift();\n};\n\n/**\n * Return header field parameters.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction params(str){\n  return reduce(str.split(/ *; */), function(obj, str){\n    var parts = str.split(/ *= */)\n      , key = parts.shift()\n      , val = parts.shift();\n\n    if (key && val) obj[key] = val;\n    return obj;\n  }, {});\n};\n\n/**\n * Initialize a new `Response` with the given `xhr`.\n *\n *  - set flags (.ok, .error, etc)\n *  - parse header\n *\n * Examples:\n *\n *  Aliasing `superagent` as `request` is nice:\n *\n *      request = superagent;\n *\n *  We can use the promise-like API, or pass callbacks:\n *\n *      request.get('/').end(function(res){});\n *      request.get('/', function(res){});\n *\n *  Sending data can be chained:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' })\n *        .end(function(res){});\n *\n *  Or passed to `.send()`:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' }, function(res){});\n *\n *  Or passed to `.post()`:\n *\n *      request\n *        .post('/user', { name: 'tj' })\n *        .end(function(res){});\n *\n * Or further reduced to a single call for simple cases:\n *\n *      request\n *        .post('/user', { name: 'tj' }, function(res){});\n *\n * @param {XMLHTTPRequest} xhr\n * @param {Object} options\n * @api private\n */\n\nfunction Response(req, options) {\n  options = options || {};\n  this.req = req;\n  this.xhr = this.req.xhr;\n  // responseText is accessible only if responseType is '' or 'text' and on older browsers\n  this.text = ((this.req.method !='HEAD' && (this.xhr.responseType === '' || this.xhr.responseType === 'text')) || typeof this.xhr.responseType === 'undefined')\n     ? this.xhr.responseText\n     : null;\n  this.statusText = this.req.xhr.statusText;\n  this.setStatusProperties(this.xhr.status);\n  this.header = this.headers = parseHeader(this.xhr.getAllResponseHeaders());\n  // getAllResponseHeaders sometimes falsely returns \"\" for CORS requests, but\n  // getResponseHeader still works. so we get content-type even if getting\n  // other headers fails.\n  this.header['content-type'] = this.xhr.getResponseHeader('content-type');\n  this.setHeaderProperties(this.header);\n  this.body = this.req.method != 'HEAD'\n    ? this.parseBody(this.text ? this.text : this.xhr.response)\n    : null;\n}\n\n/**\n * Get case-insensitive `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api public\n */\n\nResponse.prototype.get = function(field){\n  return this.header[field.toLowerCase()];\n};\n\n/**\n * Set header related properties:\n *\n *   - `.type` the content type without params\n *\n * A response of \"Content-Type: text/plain; charset=utf-8\"\n * will provide you with a `.type` of \"text/plain\".\n *\n * @param {Object} header\n * @api private\n */\n\nResponse.prototype.setHeaderProperties = function(header){\n  // content-type\n  var ct = this.header['content-type'] || '';\n  this.type = type(ct);\n\n  // params\n  var obj = params(ct);\n  for (var key in obj) this[key] = obj[key];\n};\n\n/**\n * Parse the given body `str`.\n *\n * Used for auto-parsing of bodies. Parsers\n * are defined on the `superagent.parse` object.\n *\n * @param {String} str\n * @return {Mixed}\n * @api private\n */\n\nResponse.prototype.parseBody = function(str){\n  var parse = request.parse[this.type];\n  return parse && str && (str.length || str instanceof Object)\n    ? parse(str)\n    : null;\n};\n\n/**\n * Set flags such as `.ok` based on `status`.\n *\n * For example a 2xx response will give you a `.ok` of __true__\n * whereas 5xx will be __false__ and `.error` will be __true__. The\n * `.clientError` and `.serverError` are also available to be more\n * specific, and `.statusType` is the class of error ranging from 1..5\n * sometimes useful for mapping respond colors etc.\n *\n * \"sugar\" properties are also defined for common cases. Currently providing:\n *\n *   - .noContent\n *   - .badRequest\n *   - .unauthorized\n *   - .notAcceptable\n *   - .notFound\n *\n * @param {Number} status\n * @api private\n */\n\nResponse.prototype.setStatusProperties = function(status){\n  // handle IE9 bug: http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n  if (status === 1223) {\n    status = 204;\n  }\n\n  var type = status / 100 | 0;\n\n  // status / class\n  this.status = this.statusCode = status;\n  this.statusType = type;\n\n  // basics\n  this.info = 1 == type;\n  this.ok = 2 == type;\n  this.clientError = 4 == type;\n  this.serverError = 5 == type;\n  this.error = (4 == type || 5 == type)\n    ? this.toError()\n    : false;\n\n  // sugar\n  this.accepted = 202 == status;\n  this.noContent = 204 == status;\n  this.badRequest = 400 == status;\n  this.unauthorized = 401 == status;\n  this.notAcceptable = 406 == status;\n  this.notFound = 404 == status;\n  this.forbidden = 403 == status;\n};\n\n/**\n * Return an `Error` representative of this response.\n *\n * @return {Error}\n * @api public\n */\n\nResponse.prototype.toError = function(){\n  var req = this.req;\n  var method = req.method;\n  var url = req.url;\n\n  var msg = 'cannot ' + method + ' ' + url + ' (' + this.status + ')';\n  var err = new Error(msg);\n  err.status = this.status;\n  err.method = method;\n  err.url = url;\n\n  return err;\n};\n\n/**\n * Expose `Response`.\n */\n\nrequest.Response = Response;\n\n/**\n * Initialize a new `Request` with the given `method` and `url`.\n *\n * @param {String} method\n * @param {String} url\n * @api public\n */\n\nfunction Request(method, url) {\n  var self = this;\n  Emitter.call(this);\n  this._query = this._query || [];\n  this.method = method;\n  this.url = url;\n  this.header = {};\n  this._header = {};\n  this.on('end', function(){\n    var err = null;\n    var res = null;\n\n    try {\n      res = new Response(self);\n    } catch(e) {\n      err = new Error('Parser is unable to parse the response');\n      err.parse = true;\n      err.original = e;\n      // issue #675: return the raw response if the response parsing fails\n      err.rawResponse = self.xhr && self.xhr.responseText ? self.xhr.responseText : null;\n      return self.callback(err);\n    }\n\n    self.emit('response', res);\n\n    if (err) {\n      return self.callback(err, res);\n    }\n\n    if (res.status >= 200 && res.status < 300) {\n      return self.callback(err, res);\n    }\n\n    var new_err = new Error(res.statusText || 'Unsuccessful HTTP response');\n    new_err.original = err;\n    new_err.response = res;\n    new_err.status = res.status;\n\n    self.callback(new_err, res);\n  });\n}\n\n/**\n * Mixin `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Allow for extension\n */\n\nRequest.prototype.use = function(fn) {\n  fn(this);\n  return this;\n}\n\n/**\n * Set timeout to `ms`.\n *\n * @param {Number} ms\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.timeout = function(ms){\n  this._timeout = ms;\n  return this;\n};\n\n/**\n * Clear previous timeout.\n *\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.clearTimeout = function(){\n  this._timeout = 0;\n  clearTimeout(this._timer);\n  return this;\n};\n\n/**\n * Abort the request, and clear potential timeout.\n *\n * @return {Request}\n * @api public\n */\n\nRequest.prototype.abort = function(){\n  if (this.aborted) return;\n  this.aborted = true;\n  this.xhr.abort();\n  this.clearTimeout();\n  this.emit('abort');\n  return this;\n};\n\n/**\n * Set header `field` to `val`, or multiple fields with one object.\n *\n * Examples:\n *\n *      req.get('/')\n *        .set('Accept', 'application/json')\n *        .set('X-API-Key', 'foobar')\n *        .end(callback);\n *\n *      req.get('/')\n *        .set({ Accept: 'application/json', 'X-API-Key': 'foobar' })\n *        .end(callback);\n *\n * @param {String|Object} field\n * @param {String} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.set = function(field, val){\n  if (isObject(field)) {\n    for (var key in field) {\n      this.set(key, field[key]);\n    }\n    return this;\n  }\n  this._header[field.toLowerCase()] = val;\n  this.header[field] = val;\n  return this;\n};\n\n/**\n * Remove header `field`.\n *\n * Example:\n *\n *      req.get('/')\n *        .unset('User-Agent')\n *        .end(callback);\n *\n * @param {String} field\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.unset = function(field){\n  delete this._header[field.toLowerCase()];\n  delete this.header[field];\n  return this;\n};\n\n/**\n * Get case-insensitive header `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api private\n */\n\nRequest.prototype.getHeader = function(field){\n  return this._header[field.toLowerCase()];\n};\n\n/**\n * Set Content-Type to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.xml = 'application/xml';\n *\n *      request.post('/')\n *        .type('xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n *      request.post('/')\n *        .type('application/xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n * @param {String} type\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.type = function(type){\n  this.set('Content-Type', request.types[type] || type);\n  return this;\n};\n\n/**\n * Force given parser\n *\n * Sets the body parser no matter type.\n *\n * @param {Function}\n * @api public\n */\n\nRequest.prototype.parse = function(fn){\n  this._parser = fn;\n  return this;\n};\n\n/**\n * Set Accept to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.json = 'application/json';\n *\n *      request.get('/agent')\n *        .accept('json')\n *        .end(callback);\n *\n *      request.get('/agent')\n *        .accept('application/json')\n *        .end(callback);\n *\n * @param {String} accept\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.accept = function(type){\n  this.set('Accept', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Authorization field value with `user` and `pass`.\n *\n * @param {String} user\n * @param {String} pass\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.auth = function(user, pass){\n  var str = btoa(user + ':' + pass);\n  this.set('Authorization', 'Basic ' + str);\n  return this;\n};\n\n/**\n* Add query-string `val`.\n*\n* Examples:\n*\n*   request.get('/shoes')\n*     .query('size=10')\n*     .query({ color: 'blue' })\n*\n* @param {Object|String} val\n* @return {Request} for chaining\n* @api public\n*/\n\nRequest.prototype.query = function(val){\n  if ('string' != typeof val) val = serialize(val);\n  if (val) this._query.push(val);\n  return this;\n};\n\n/**\n * Write the field `name` and `val` for \"multipart/form-data\"\n * request bodies.\n *\n * ``` js\n * request.post('/upload')\n *   .field('foo', 'bar')\n *   .end(callback);\n * ```\n *\n * @param {String} name\n * @param {String|Blob|File} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.field = function(name, val){\n  if (!this._formData) this._formData = new root.FormData();\n  this._formData.append(name, val);\n  return this;\n};\n\n/**\n * Queue the given `file` as an attachment to the specified `field`,\n * with optional `filename`.\n *\n * ``` js\n * request.post('/upload')\n *   .attach(new Blob(['<a id=\"a\"><b id=\"b\">hey!</b></a>'], { type: \"text/html\"}))\n *   .end(callback);\n * ```\n *\n * @param {String} field\n * @param {Blob|File} file\n * @param {String} filename\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.attach = function(field, file, filename){\n  if (!this._formData) this._formData = new root.FormData();\n  this._formData.append(field, file, filename);\n  return this;\n};\n\n/**\n * Send `data`, defaulting the `.type()` to \"json\" when\n * an object is given.\n *\n * Examples:\n *\n *       // querystring\n *       request.get('/search')\n *         .end(callback)\n *\n *       // multiple data \"writes\"\n *       request.get('/search')\n *         .send({ search: 'query' })\n *         .send({ range: '1..5' })\n *         .send({ order: 'desc' })\n *         .end(callback)\n *\n *       // manual json\n *       request.post('/user')\n *         .type('json')\n *         .send('{\"name\":\"tj\"}')\n *         .end(callback)\n *\n *       // auto json\n *       request.post('/user')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // manual x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send('name=tj')\n *         .end(callback)\n *\n *       // auto x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // defaults to x-www-form-urlencoded\n  *      request.post('/user')\n  *        .send('name=tobi')\n  *        .send('species=ferret')\n  *        .end(callback)\n *\n * @param {String|Object} data\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.send = function(data){\n  var obj = isObject(data);\n  var type = this.getHeader('Content-Type');\n\n  // merge\n  if (obj && isObject(this._data)) {\n    for (var key in data) {\n      this._data[key] = data[key];\n    }\n  } else if ('string' == typeof data) {\n    if (!type) this.type('form');\n    type = this.getHeader('Content-Type');\n    if ('application/x-www-form-urlencoded' == type) {\n      this._data = this._data\n        ? this._data + '&' + data\n        : data;\n    } else {\n      this._data = (this._data || '') + data;\n    }\n  } else {\n    this._data = data;\n  }\n\n  if (!obj || isHost(data)) return this;\n  if (!type) this.type('json');\n  return this;\n};\n\n/**\n * Invoke the callback with `err` and `res`\n * and handle arity check.\n *\n * @param {Error} err\n * @param {Response} res\n * @api private\n */\n\nRequest.prototype.callback = function(err, res){\n  var fn = this._callback;\n  this.clearTimeout();\n  fn(err, res);\n};\n\n/**\n * Invoke callback with x-domain error.\n *\n * @api private\n */\n\nRequest.prototype.crossDomainError = function(){\n  var err = new Error('Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.');\n  err.crossDomain = true;\n\n  err.status = this.status;\n  err.method = this.method;\n  err.url = this.url;\n\n  this.callback(err);\n};\n\n/**\n * Invoke callback with timeout error.\n *\n * @api private\n */\n\nRequest.prototype.timeoutError = function(){\n  var timeout = this._timeout;\n  var err = new Error('timeout of ' + timeout + 'ms exceeded');\n  err.timeout = timeout;\n  this.callback(err);\n};\n\n/**\n * Enable transmission of cookies with x-domain requests.\n *\n * Note that for this to work the origin must not be\n * using \"Access-Control-Allow-Origin\" with a wildcard,\n * and also must set \"Access-Control-Allow-Credentials\"\n * to \"true\".\n *\n * @api public\n */\n\nRequest.prototype.withCredentials = function(){\n  this._withCredentials = true;\n  return this;\n};\n\n/**\n * Initiate request, invoking callback `fn(res)`\n * with an instanceof `Response`.\n *\n * @param {Function} fn\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.end = function(fn){\n  var self = this;\n  var xhr = this.xhr = request.getXHR();\n  var query = this._query.join('&');\n  var timeout = this._timeout;\n  var data = this._formData || this._data;\n\n  // store callback\n  this._callback = fn || noop;\n\n  // state change\n  xhr.onreadystatechange = function(){\n    if (4 != xhr.readyState) return;\n\n    // In IE9, reads to any property (e.g. status) off of an aborted XHR will\n    // result in the error \"Could not complete the operation due to error c00c023f\"\n    var status;\n    try { status = xhr.status } catch(e) { status = 0; }\n\n    if (0 == status) {\n      if (self.timedout) return self.timeoutError();\n      if (self.aborted) return;\n      return self.crossDomainError();\n    }\n    self.emit('end');\n  };\n\n  // progress\n  var handleProgress = function(e){\n    if (e.total > 0) {\n      e.percent = e.loaded / e.total * 100;\n    }\n    self.emit('progress', e);\n  };\n  if (this.hasListeners('progress')) {\n    xhr.onprogress = handleProgress;\n  }\n  try {\n    if (xhr.upload && this.hasListeners('progress')) {\n      xhr.upload.onprogress = handleProgress;\n    }\n  } catch(e) {\n    // Accessing xhr.upload fails in IE from a web worker, so just pretend it doesn't exist.\n    // Reported here:\n    // https://connect.microsoft.com/IE/feedback/details/837245/xmlhttprequest-upload-throws-invalid-argument-when-used-from-web-worker-context\n  }\n\n  // timeout\n  if (timeout && !this._timer) {\n    this._timer = setTimeout(function(){\n      self.timedout = true;\n      self.abort();\n    }, timeout);\n  }\n\n  // querystring\n  if (query) {\n    query = request.serializeObject(query);\n    this.url += ~this.url.indexOf('?')\n      ? '&' + query\n      : '?' + query;\n  }\n\n  // initiate request\n  xhr.open(this.method, this.url, true);\n\n  // CORS\n  if (this._withCredentials) xhr.withCredentials = true;\n\n  // body\n  if ('GET' != this.method && 'HEAD' != this.method && 'string' != typeof data && !isHost(data)) {\n    // serialize stuff\n    var contentType = this.getHeader('Content-Type');\n    var serialize = this._parser || request.serialize[contentType ? contentType.split(';')[0] : ''];\n    if (!serialize && isJSON(contentType)) serialize = request.serialize['application/json'];\n    if (serialize) data = serialize(data);\n  }\n\n  // set header fields\n  for (var field in this.header) {\n    if (null == this.header[field]) continue;\n    xhr.setRequestHeader(field, this.header[field]);\n  }\n\n  // send stuff\n  this.emit('request', this);\n\n  // IE11 xhr.send(undefined) sends 'undefined' string as POST payload (instead of nothing)\n  // We need null here if data is undefined\n  xhr.send(typeof data !== 'undefined' ? data : null);\n  return this;\n};\n\n/**\n * Faux promise support\n *\n * @param {Function} fulfill\n * @param {Function} reject\n * @return {Request}\n */\n\nRequest.prototype.then = function (fulfill, reject) {\n  return this.end(function(err, res) {\n    err ? reject(err) : fulfill(res);\n  });\n}\n\n/**\n * Expose `Request`.\n */\n\nrequest.Request = Request;\n\n/**\n * Issue a request:\n *\n * Examples:\n *\n *    request('GET', '/users').end(callback)\n *    request('/users').end(callback)\n *    request('/users', callback)\n *\n * @param {String} method\n * @param {String|Function} url or callback\n * @return {Request}\n * @api public\n */\n\nfunction request(method, url) {\n  // callback\n  if ('function' == typeof url) {\n    return new Request('GET', method).end(url);\n  }\n\n  // url first\n  if (1 == arguments.length) {\n    return new Request('GET', method);\n  }\n\n  return new Request(method, url);\n}\n\n/**\n * GET `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.get = function(url, data, fn){\n  var req = request('GET', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.query(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * HEAD `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.head = function(url, data, fn){\n  var req = request('HEAD', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * DELETE `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nfunction del(url, fn){\n  var req = request('DELETE', url);\n  if (fn) req.end(fn);\n  return req;\n};\n\nrequest.del = del;\nrequest.delete = del;\n\n/**\n * PATCH `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.patch = function(url, data, fn){\n  var req = request('PATCH', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * POST `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.post = function(url, data, fn){\n  var req = request('POST', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * PUT `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.put = function(url, data, fn){\n  var req = request('PUT', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * Expose `request`.\n */\n\nmodule.exports = request;\n\n},{\"emitter\":1,\"reduce\":4}],6:[function(require,module,exports){\n'use strict';\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/* global localStorage */\nvar Table = require('./table');\n\nmodule.exports = function Database(name, options) {\n  _classCallCheck(this, Database);\n\n  this.url = name || '/api/';\n  if (!this.url.match(/\\/$/)) {\n    this.url += '/';\n  }\n\n  options = options || {};\n  this.odata = options.odata || false;\n  this.cacheTTL = options.cacheTTL || 10 * 60 * 1000; // 10 minutes\n  this.cacheByDefault = options.cacheByDefault || false;\n  this.storage = options.storage || localStorage;\n  this.plugins = options.plugins || [];\n  this.onEnd = options.onEnd || false;\n\n  var self = this;\n  var _database = function _database(table) {\n    return new Table(self, table);\n  };\n  // `public` functions\n  this.plugins.forEach(function (plugin) {\n    plugin.call(self);\n  });\n\n  return _database;\n};\n\n},{\"./table\":11}],7:[function(require,module,exports){\n(function (global){\n'use strict';\n\n// The Export Module\nglobal.Unrest = require('./database');\nglobal.Unrest.superagent = require('superagent');\n\nmodule.exports = global.Unrest;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{\"./database\":6,\"superagent\":5}],8:[function(require,module,exports){\n\"use strict\";\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar parser = require('odata-filter-parser');\n\nmodule.exports = (function () {\n  function Odata(query) {\n    _classCallCheck(this, Odata);\n\n    this._query = query;\n  }\n\n  _createClass(Odata, [{\n    key: \"toString\",\n    value: function toString() {\n      var g = [],\n          q = this._query;\n      console.log(q);\n      if (q.order.length > 0) {\n        var b = \"$orderby=\";\n        q.order.forEach(function (i) {\n          b += i[0] + (i[1] == \"desc\" ? \" desc\" : \"\") + \",\";\n        });\n        b = b.substring(0, b.length - 1);\n        g.push(b);\n      }\n      if (q.skip) g.push(\"$skip=\" + parseInt(q.skip));\n      if (q.take) g.push(\"$top=\" + parseInt(q.take));\n      if (q.where.length > 0) {\n        var b = \"$filter=\";\n        q.where.forEach(function (i) {\n          b += new parser.Predicate(i).serialize() + \" and \";\n        });\n        b = b.substring(0, b.length - 5);\n        g.push(b);\n      }\n      if (q.select.length > 0) g.push(\"$select=\" + q.select.join(\",\"));\n      return g.join(\"&\");\n    }\n  }]);\n\n  return Odata;\n})();\n\n},{\"odata-filter-parser\":3}],9:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nmodule.exports = (function () {\n  function Query() {\n    _classCallCheck(this, Query);\n\n    this._query = {\n      order: [],\n      select: [],\n      where: [],\n      skip: null,\n      take: null\n    };\n  }\n\n  _createClass(Query, [{\n    key: 'orderBy',\n    value: function orderBy() {\n      var _this = this;\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      args.forEach(function (arg) {\n        _this._query.order.push([arg[0] == '-' ? arg.substring(1, arg.length) : arg, arg[0] == '-' ? 'desc' : 'asc']);\n      });\n      return this;\n    }\n  }, {\n    key: 'select',\n    value: function select() {\n      var _this2 = this;\n\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      args.forEach(function (arg) {\n        _this2._query.select.push(arg);\n      });\n      return this;\n    }\n  }, {\n    key: 'where',\n    value: function where(pred) {\n      this._query.where.push(pred);\n      return this;\n    }\n  }, {\n    key: 'skip',\n    value: function skip(amount) {\n      this._query.skip = amount;\n      return this;\n    }\n  }, {\n    key: 'take',\n    value: function take(amount) {\n      this._query.take = amount;\n      return this;\n    }\n  }]);\n\n  return Query;\n})();\n\n},{}],10:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _typeof(obj) { return obj && typeof Symbol !== \"undefined\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; }\n\nvar xhr = require('superagent');\nvar odata = require('./odata');\n\nfunction jsonify(agent) {\n  return agent.type('application/json').accept('json');\n}\n\nfunction handleResponses(request) {\n  request._status = 'pending';\n  request.pending = true;\n  var method = request._agent.method;\n  var url = request._agent.url;\n  var CACHE_KEY = 'unrest-' + method + '-' + url;\n  var storageProvider = request._table._database.storage;\n\n  // //\n  // Perform Cache\n  if (request._cache) {\n    var cache = JSON.parse(storageProvider.getItem(CACHE_KEY));\n\n    if (cache) {\n      // if the cache exists and isn't old\n      if (cache.time && request._cache > +new Date() - cache.time) {\n        request._onSuccess.forEach(function (cb) {\n          cb(cache.data, true);\n        });\n        request._cachedata = cache.data;\n      } else {\n        storageProvider.removeItem(CACHE_KEY);\n      }\n    }\n  }\n\n  // //\n  // Handle Response\n  request._agent.end(function (err, res) {\n    request._status = 'resolved';\n    delete request.pending;\n    if (err) {\n      // on error\n      request.error = err;\n      // debugger;\n      request._onError.forEach(function (cb) {\n        cb(err);\n      });\n    } else {\n      // on success\n      request._data = res.body;\n      if (request._cache) {\n        storageProvider.setItem(CACHE_KEY, JSON.stringify({\n          time: +new Date(),\n          data: request._data\n        }));\n      }\n      // //\n      // perform injection\n      if (_typeof(res.body) === 'object' && !Array.isArray(res.body)) {\n        for (var prop in request._data) {\n          request[prop] = request._data[prop];\n        }\n      } else {\n        request.data = request._data;\n      }\n      // //\n      // perform calbacks.\n      request._onSuccess.forEach(function (cb) {\n        cb(res.body);\n      });\n    }\n    if (request._table._database.onEnd) request._table._database.onEnd();\n  });\n}\n\nmodule.exports = (function () {\n  function Request(table) {\n    _classCallCheck(this, Request);\n\n    this._table = table;\n    this._status = 'idle';\n    this._onSuccess = [];\n    this._onError = [];\n    if (this._table._database.cacheByDefault) {\n      this._cache = this._table._database.cacheTTL;\n    }\n  }\n\n  _createClass(Request, [{\n    key: 'cacheable',\n    value: function cacheable(lifetime) {\n      if (this._status !== 'idle' && this._status !== 'pending') {\n        console.error('cacheable could not be set before request was sent out. Ensure this is called before query, fetch, save, then, etc');\n      }\n      if (!lifetime) {\n        lifetime = this._table._database.cacheTTL;\n      }\n      this._cache = lifetime;\n      return this;\n    }\n  }, {\n    key: 'odata',\n    value: function odata() {\n      return this._table._database.odata;\n    }\n  }, {\n    key: 'resource',\n    value: function resource(id) {\n      id = id.toString();\n      return this._table.url + (this.odata() ? '(' + id + ')' : '/' + id);\n    }\n    // QUERY GET /table/\n    // Returns a list.\n\n  }, {\n    key: 'query',\n    value: function query(options) {\n      this._agent = xhr.get(this._table.url + (this.odata() ? \"?\" + new odata(this._table._query).toString() : \"\")).query(options);\n      jsonify(this._agent);\n      if (this._status === 'idle') handleResponses(this);\n      return this;\n    }\n  }, {\n    key: 'fetch',\n    value: function fetch(id, options) {\n      this._agent = xhr.get(this.resource(id)).query(options);\n      jsonify(this._agent);\n      if (this._status === 'idle') handleResponses(this);\n      return this;\n    }\n  }, {\n    key: 'save',\n    value: function save(obj) {\n      var r = null;\n      var id = obj.Id || obj.id;\n      if (!id || id === 0) {\n        r = xhr.post(this._table.url);\n      } else {\n        r = xhr.put(this.resource(id));\n      }\n      this._agent = r.send(obj);\n      jsonify(this._agent);\n      if (this._status === 'idle') handleResponses(this);\n      return this;\n    }\n  }, {\n    key: 'remove',\n    value: function remove(Id) {\n      this._agent = xhr.del(this.resource(Id));\n      jsonify(this._agent);\n      return this;\n    }\n  }, {\n    key: 'then',\n    value: function then(cb) {\n      if (this._status === 'resolved' && !this.error) {\n        cb(this._data);\n      } else {\n        this._onSuccess.push(cb);\n      }\n      if (this._status === 'idle') handleResponses(this);\n      if (this._status === 'pending' && this._cachedata) {\n        cb(this._cachedata, true);\n      }\n      return this;\n    }\n  }, {\n    key: 'catch',\n    value: function _catch(cb) {\n      if (this._status === 'resolved' && this.error) {\n        cb(this.error);\n      } else {\n        this._onError.push(cb);\n      }\n      if (this._status === 'idle') handleResponses(this);\n      return this;\n    }\n  }, {\n    key: 'status',\n    value: function status() {\n      return this._status;\n    }\n  }]);\n\n  return Request;\n})();\n\n},{\"./odata\":8,\"superagent\":5}],11:[function(require,module,exports){\n'use strict';\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Request = require('./request');\nvar Query = require('./query');\n\nmodule.exports = (function (_Query) {\n  _inherits(Table, _Query);\n\n  function Table(database, table) {\n    _classCallCheck(this, Table);\n\n    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(Table).call(this));\n\n    _this._database = database;\n    _this.url = database.url + table;\n    _this.name = table;\n    _this.events = {};\n    return _this;\n  }\n\n  _createClass(Table, [{\n    key: 'query',\n    value: function query(options) {\n      return new Request(this).query(options);\n    }\n  }, {\n    key: 'fetch',\n    value: function fetch(id) {\n      return new Request(this).fetch(id);\n    }\n  }, {\n    key: 'save',\n    value: function save(object) {\n      return new Request(this).save(object);\n    }\n  }, {\n    key: 'remove',\n    value: function remove(obj) {\n      return new Request(this).remove(obj);\n    }\n  }, {\n    key: 'cacheable',\n    value: function cacheable(obj) {\n      return new Request(this).cacheable(obj);\n    }\n  }]);\n\n  return Table;\n})(Query);\n\n},{\"./query\":9,\"./request\":10}]},{},[7])\n\n","/**\r\n Copyright 2015 Jason Drake\r\n\r\n Licensed under the Apache License, Version 2.0 (the \"License\");\r\n you may not use this file except in compliance with the License.\r\n You may obtain a copy of the License at\r\n\r\n http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n Unless required by applicable law or agreed to in writing, software\r\n distributed under the License is distributed on an \"AS IS\" BASIS,\r\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n See the License for the specific language governing permissions and\r\n limitations under the License.\r\n */\r\n\r\nvar Operators = {\r\n    EQUALS: 'eq',\r\n    AND: 'and',\r\n    OR: 'or',\r\n    GREATER_THAN: 'gt',\r\n    GREATER_THAN_EQUAL: 'ge',\r\n    LESS_THAN: 'lt',\r\n    LESS_THAN_EQUAL: 'le',\r\n    LIKE: 'like',\r\n    IS_NULL: 'is null',\r\n    NOT_EQUAL: 'ne',\r\n\r\n    /**\r\n     * Whether a defined operation is unary or binary.  Will return true\r\n     * if the operation only supports a subject with no value.\r\n     *\r\n     * @param {String} op the operation to check.\r\n     * @return {Boolean} whether the operation is an unary operation.\r\n     */\r\n    isUnary: function (op) {\r\n        var value = false;\r\n        if (op === Operators.IS_NULL) {\r\n            value = true;\r\n        }\r\n        return value;\r\n    },\r\n    /**\r\n     * Whether a defined operation is a logical operators or not.\r\n     *\r\n     * @param {String} op the operation to check.\r\n     * @return {Boolean} whether the operation is a logical operation.\r\n     */\r\n    isLogical: function (op) {\r\n        return (op === Operators.AND || op === Operators.OR);\r\n    }\r\n};\r\n\r\n/**\r\n * Predicate is the basic model construct of the odata expression\r\n *\r\n * @param config\r\n * @returns {Predicate}\r\n * @constructor\r\n */\r\nvar Predicate = function (config) {\r\n    if (!config) {\r\n        config = {};\r\n    }\r\n    this.subject = config.subject;\r\n    this.value = config.value;\r\n    this.operator = (config.operator) ? config.operator : Operators.EQUALS;\r\n    return this;\r\n};\r\n\r\nPredicate.concat = function (operator, p) {\r\n    if (arguments.length < 3 && !(p instanceof Array && p.length >= 2)) {\r\n        throw {\r\n            key: 'INSUFFICIENT_PREDICATES',\r\n            msg: 'At least two predicates are required'\r\n        };\r\n    } else if (!operator || !Operators.isLogical(operator)) {\r\n        throw {\r\n            key: 'INVALID_LOGICAL',\r\n            msg: 'The operator is not representative of a logical operator.'\r\n        };\r\n    }\r\n    var result;\r\n    var arr = [];\r\n    if( p instanceof Array ) {\r\n        arr = p;\r\n    } else {\r\n        for( var i = 1; i < arguments.length; i++ ) {\r\n            arr.push( arguments[i] );\r\n        }\r\n    }\r\n    var len = arr.length;\r\n    result = new Predicate({\r\n        subject: arr[0],\r\n        operator: operator\r\n    });\r\n    if (len === 2) {\r\n        result.value = arr[len - 1];\r\n    } else {\r\n        var a = [];\r\n        for( var j = 1; j < len; j++ ) {\r\n            a.push(arr[j]);\r\n        }\r\n        result.value = Predicate.concat(operator, a);\r\n    }\r\n    return result;\r\n};\r\n\r\nPredicate.prototype.flatten = function(result) {\r\n    if( !result ) {\r\n        result = [];\r\n    }\r\n    if( Operators.isLogical(this.operator) ) {\r\n        result = result.concat(this.subject.flatten());\r\n        result = result.concat(this.value.flatten());\r\n    } else {\r\n        result.push(this);\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Will serialie the predicate to an ODATA compliant serialized string.\r\n *\r\n * @return {String} The compliant ODATA query string\r\n */\r\nPredicate.prototype.serialize = function() {\r\n    var retValue = '';\r\n    if (this.operator) {\r\n        if (this.subject === undefined || this.subject === null) {\r\n            throw {\r\n                key: 'INVALID_SUBJECT',\r\n                msg: 'The subject is required and is not specified.'\r\n            };\r\n        }\r\n        if (Operators.isLogical(this.operator) && (!(this.subject instanceof Predicate ||\r\n            this.value instanceof Predicate) || (this.subject instanceof Predicate && this.value === undefined))) {\r\n            throw {\r\n                key: 'INVALID_LOGICAL',\r\n                msg: 'The predicate does not represent a valid logical expression.'\r\n            };\r\n        }\r\n        retValue = '(' + ((this.subject instanceof Predicate) ? this.subject.serialize() : this.subject) + ' ' + this.operator;\r\n        if (!Operators.isUnary(this.operator)) {\r\n            if (this.value === undefined || this.value === null) {\r\n                throw {\r\n                    key: 'INVALID_VALUE',\r\n                    msg: 'The value was required but was not defined.'\r\n                };\r\n            }\r\n            retValue += ' ';\r\n            var val = typeof this.value;\r\n            if (val === 'string') {\r\n                retValue += '\\'' + this.value + '\\'';\r\n            } else if (val === 'number' || val === 'boolean') {\r\n                retValue += this.value;\r\n            } else if (this.value instanceof Predicate) {\r\n                retValue += this.value.serialize();\r\n            } else if (this.value instanceof Date) {\r\n                retValue += 'datetimeoffset\\'' + this.value.toISOString() + '\\'';\r\n            } else {\r\n                throw {\r\n                    key: 'UNKNOWN_TYPE',\r\n                    msg: 'Unsupported value type: ' + (typeof this.value),\r\n                    source: this.value\r\n                };\r\n            }\r\n\r\n        }\r\n        retValue += ')';\r\n    }\r\n    return retValue;\r\n};\r\n\r\nvar ODataParser = function() {\r\n\r\n    \"use strict\";\r\n\r\n    var REGEX = {\r\n        parenthesis: /^([(](.*)[)])$/,\r\n        andor: /^(.*?) (or|and)+ (.*)$/,\r\n        op: /(\\w*) (eq|gt|lt|ge|le|ne) (datetimeoffset'(.*)'|'(.*)'|[0-9]*)/,\r\n        startsWith: /^startswith[(](.*),'(.*)'[)]/,\r\n        endsWith: /^endswith[(](.*),'(.*)'[)]/,\r\n        contains: /^contains[(](.*),'(.*)'[)]/\r\n    };\r\n\r\n    function buildLike(match, key) {\r\n        var right = (key === 'startsWith') ? match[2] + '*' : (key === 'endsWith') ? '*' + match[2] : '*' + match[2] + '*';\r\n        if( match[0].charAt(match[0].lastIndexOf(')') - 1) === \"\\'\") {\r\n            right = \"\\'\" + right + \"\\'\";\r\n        }\r\n        return {\r\n            subject: match[1],\r\n            operator: Operators.LIKE,\r\n            value: right\r\n        };\r\n    }\r\n\r\n    function parseFragment(filter) {\r\n        var found = false;\r\n        var obj = null;\r\n        for (var key in REGEX ) {\r\n            var regex = REGEX[key];\r\n            if( found ) {\r\n                break;\r\n            }\r\n            var match = filter.match(regex);\r\n            if( match ) {\r\n                switch (regex) {\r\n                    case REGEX.parenthesis:\r\n                        if( match.length > 2 ) {\r\n                            if( match[2].indexOf(')') < match[2].indexOf('(')) {\r\n                                continue;\r\n                            }\r\n                            obj = parseFragment(match[2]);\r\n                        }\r\n                        break;\r\n                    case REGEX.andor:\r\n                        obj = new Predicate({\r\n                            subject: parseFragment(match[1]),\r\n                            operator: match[2],\r\n                            value: parseFragment(match[3])\r\n                        });\r\n                        break;\r\n                    case REGEX.op:\r\n                        obj = new Predicate({\r\n                            subject: match[1],\r\n                            operator: match[2],\r\n                            value: ( match[3].indexOf('\\'') === -1) ? +match[3] : match[3]\r\n                        });\r\n                        if(obj.value.indexOf && obj.value.indexOf(\"datetimeoffset\") === 0) {\r\n                            var m = obj.value.match(/^datetimeoffset'(.*)'$/);\r\n                            if( m && m.length > 1) {\r\n                                obj.value = new Date(m[1]);\r\n                            }\r\n                        }\r\n                        break;\r\n                    case REGEX.startsWith:\r\n                    case REGEX.endsWith:\r\n                    case REGEX.contains:\r\n                        obj = buildLike(match, key);\r\n                        break;\r\n                }\r\n                found = true;\r\n            }\r\n        }\r\n        return obj;\r\n    }\r\n\r\n    return {\r\n        parse: function(filterStr) {\r\n            if( !filterStr || filterStr === '') {\r\n                return null;\r\n            }\r\n            var filter = filterStr.trim();\r\n            var obj = {};\r\n            if( filter.length > 0 ) {\r\n                obj = parseFragment(filter);\r\n            }\r\n            return obj;\r\n        }\r\n    };\r\n}();\r\n\r\n\r\n\r\nmodule.exports = {\r\n    Parser: ODataParser,\r\n    Operators: Operators,\r\n    Predicate: Predicate\r\n};","/**\r\n Copyright 2015 Jason Drake\r\n\r\n Licensed under the Apache License, Version 2.0 (the \"License\");\r\n you may not use this file except in compliance with the License.\r\n You may obtain a copy of the License at\r\n\r\n http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n Unless required by applicable law or agreed to in writing, software\r\n distributed under the License is distributed on an \"AS IS\" BASIS,\r\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n See the License for the specific language governing permissions and\r\n limitations under the License.\r\n */\r\n\r\nmodule.exports = {\r\n    Predicate: require('./dist/odata-parser').Predicate,\r\n    Operators: require('./dist/odata-parser').Operators,\r\n    Parser: require('./dist/odata-parser').Parser\r\n}","\n/**\n * Reduce `arr` with `fn`.\n *\n * @param {Array} arr\n * @param {Function} fn\n * @param {Mixed} initial\n *\n * TODO: combatible error handling?\n */\n\nmodule.exports = function(arr, fn, initial){  \n  var idx = 0;\n  var len = arr.length;\n  var curr = arguments.length == 3\n    ? initial\n    : arr[idx++];\n\n  while (idx < len) {\n    curr = fn.call(null, curr, arr[idx], ++idx, arr);\n  }\n  \n  return curr;\n};","/**\n * Module dependencies.\n */\n\nvar Emitter = require('emitter');\nvar reduce = require('reduce');\n\n/**\n * Root reference for iframes.\n */\n\nvar root;\nif (typeof window !== 'undefined') { // Browser window\n  root = window;\n} else if (typeof self !== 'undefined') { // Web Worker\n  root = self;\n} else { // Other environments\n  root = this;\n}\n\n/**\n * Noop.\n */\n\nfunction noop(){};\n\n/**\n * Check if `obj` is a host object,\n * we don't want to serialize these :)\n *\n * TODO: future proof, move to compoent land\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isHost(obj) {\n  var str = {}.toString.call(obj);\n\n  switch (str) {\n    case '[object File]':\n    case '[object Blob]':\n    case '[object FormData]':\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Determine XHR.\n */\n\nrequest.getXHR = function () {\n  if (root.XMLHttpRequest\n      && (!root.location || 'file:' != root.location.protocol\n          || !root.ActiveXObject)) {\n    return new XMLHttpRequest;\n  } else {\n    try { return new ActiveXObject('Microsoft.XMLHTTP'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.6.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.3.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP'); } catch(e) {}\n  }\n  return false;\n};\n\n/**\n * Removes leading and trailing whitespace, added to support IE.\n *\n * @param {String} s\n * @return {String}\n * @api private\n */\n\nvar trim = ''.trim\n  ? function(s) { return s.trim(); }\n  : function(s) { return s.replace(/(^\\s*|\\s*$)/g, ''); };\n\n/**\n * Check if `obj` is an object.\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Serialize the given `obj`.\n *\n * @param {Object} obj\n * @return {String}\n * @api private\n */\n\nfunction serialize(obj) {\n  if (!isObject(obj)) return obj;\n  var pairs = [];\n  for (var key in obj) {\n    if (null != obj[key]) {\n      pushEncodedKeyValuePair(pairs, key, obj[key]);\n        }\n      }\n  return pairs.join('&');\n}\n\n/**\n * Helps 'serialize' with serializing arrays.\n * Mutates the pairs array.\n *\n * @param {Array} pairs\n * @param {String} key\n * @param {Mixed} val\n */\n\nfunction pushEncodedKeyValuePair(pairs, key, val) {\n  if (Array.isArray(val)) {\n    return val.forEach(function(v) {\n      pushEncodedKeyValuePair(pairs, key, v);\n    });\n  }\n  pairs.push(encodeURIComponent(key)\n    + '=' + encodeURIComponent(val));\n}\n\n/**\n * Expose serialization method.\n */\n\n request.serializeObject = serialize;\n\n /**\n  * Parse the given x-www-form-urlencoded `str`.\n  *\n  * @param {String} str\n  * @return {Object}\n  * @api private\n  */\n\nfunction parseString(str) {\n  var obj = {};\n  var pairs = str.split('&');\n  var parts;\n  var pair;\n\n  for (var i = 0, len = pairs.length; i < len; ++i) {\n    pair = pairs[i];\n    parts = pair.split('=');\n    obj[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);\n  }\n\n  return obj;\n}\n\n/**\n * Expose parser.\n */\n\nrequest.parseString = parseString;\n\n/**\n * Default MIME type map.\n *\n *     superagent.types.xml = 'application/xml';\n *\n */\n\nrequest.types = {\n  html: 'text/html',\n  json: 'application/json',\n  xml: 'application/xml',\n  urlencoded: 'application/x-www-form-urlencoded',\n  'form': 'application/x-www-form-urlencoded',\n  'form-data': 'application/x-www-form-urlencoded'\n};\n\n/**\n * Default serialization map.\n *\n *     superagent.serialize['application/xml'] = function(obj){\n *       return 'generated xml here';\n *     };\n *\n */\n\n request.serialize = {\n   'application/x-www-form-urlencoded': serialize,\n   'application/json': JSON.stringify\n };\n\n /**\n  * Default parsers.\n  *\n  *     superagent.parse['application/xml'] = function(str){\n  *       return { object parsed from str };\n  *     };\n  *\n  */\n\nrequest.parse = {\n  'application/x-www-form-urlencoded': parseString,\n  'application/json': JSON.parse\n};\n\n/**\n * Parse the given header `str` into\n * an object containing the mapped fields.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction parseHeader(str) {\n  var lines = str.split(/\\r?\\n/);\n  var fields = {};\n  var index;\n  var line;\n  var field;\n  var val;\n\n  lines.pop(); // trailing CRLF\n\n  for (var i = 0, len = lines.length; i < len; ++i) {\n    line = lines[i];\n    index = line.indexOf(':');\n    field = line.slice(0, index).toLowerCase();\n    val = trim(line.slice(index + 1));\n    fields[field] = val;\n  }\n\n  return fields;\n}\n\n/**\n * Check if `mime` is json or has +json structured syntax suffix.\n *\n * @param {String} mime\n * @return {Boolean}\n * @api private\n */\n\nfunction isJSON(mime) {\n  return /[\\/+]json\\b/.test(mime);\n}\n\n/**\n * Return the mime type for the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nfunction type(str){\n  return str.split(/ *; */).shift();\n};\n\n/**\n * Return header field parameters.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction params(str){\n  return reduce(str.split(/ *; */), function(obj, str){\n    var parts = str.split(/ *= */)\n      , key = parts.shift()\n      , val = parts.shift();\n\n    if (key && val) obj[key] = val;\n    return obj;\n  }, {});\n};\n\n/**\n * Initialize a new `Response` with the given `xhr`.\n *\n *  - set flags (.ok, .error, etc)\n *  - parse header\n *\n * Examples:\n *\n *  Aliasing `superagent` as `request` is nice:\n *\n *      request = superagent;\n *\n *  We can use the promise-like API, or pass callbacks:\n *\n *      request.get('/').end(function(res){});\n *      request.get('/', function(res){});\n *\n *  Sending data can be chained:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' })\n *        .end(function(res){});\n *\n *  Or passed to `.send()`:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' }, function(res){});\n *\n *  Or passed to `.post()`:\n *\n *      request\n *        .post('/user', { name: 'tj' })\n *        .end(function(res){});\n *\n * Or further reduced to a single call for simple cases:\n *\n *      request\n *        .post('/user', { name: 'tj' }, function(res){});\n *\n * @param {XMLHTTPRequest} xhr\n * @param {Object} options\n * @api private\n */\n\nfunction Response(req, options) {\n  options = options || {};\n  this.req = req;\n  this.xhr = this.req.xhr;\n  // responseText is accessible only if responseType is '' or 'text' and on older browsers\n  this.text = ((this.req.method !='HEAD' && (this.xhr.responseType === '' || this.xhr.responseType === 'text')) || typeof this.xhr.responseType === 'undefined')\n     ? this.xhr.responseText\n     : null;\n  this.statusText = this.req.xhr.statusText;\n  this.setStatusProperties(this.xhr.status);\n  this.header = this.headers = parseHeader(this.xhr.getAllResponseHeaders());\n  // getAllResponseHeaders sometimes falsely returns \"\" for CORS requests, but\n  // getResponseHeader still works. so we get content-type even if getting\n  // other headers fails.\n  this.header['content-type'] = this.xhr.getResponseHeader('content-type');\n  this.setHeaderProperties(this.header);\n  this.body = this.req.method != 'HEAD'\n    ? this.parseBody(this.text ? this.text : this.xhr.response)\n    : null;\n}\n\n/**\n * Get case-insensitive `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api public\n */\n\nResponse.prototype.get = function(field){\n  return this.header[field.toLowerCase()];\n};\n\n/**\n * Set header related properties:\n *\n *   - `.type` the content type without params\n *\n * A response of \"Content-Type: text/plain; charset=utf-8\"\n * will provide you with a `.type` of \"text/plain\".\n *\n * @param {Object} header\n * @api private\n */\n\nResponse.prototype.setHeaderProperties = function(header){\n  // content-type\n  var ct = this.header['content-type'] || '';\n  this.type = type(ct);\n\n  // params\n  var obj = params(ct);\n  for (var key in obj) this[key] = obj[key];\n};\n\n/**\n * Parse the given body `str`.\n *\n * Used for auto-parsing of bodies. Parsers\n * are defined on the `superagent.parse` object.\n *\n * @param {String} str\n * @return {Mixed}\n * @api private\n */\n\nResponse.prototype.parseBody = function(str){\n  var parse = request.parse[this.type];\n  return parse && str && (str.length || str instanceof Object)\n    ? parse(str)\n    : null;\n};\n\n/**\n * Set flags such as `.ok` based on `status`.\n *\n * For example a 2xx response will give you a `.ok` of __true__\n * whereas 5xx will be __false__ and `.error` will be __true__. The\n * `.clientError` and `.serverError` are also available to be more\n * specific, and `.statusType` is the class of error ranging from 1..5\n * sometimes useful for mapping respond colors etc.\n *\n * \"sugar\" properties are also defined for common cases. Currently providing:\n *\n *   - .noContent\n *   - .badRequest\n *   - .unauthorized\n *   - .notAcceptable\n *   - .notFound\n *\n * @param {Number} status\n * @api private\n */\n\nResponse.prototype.setStatusProperties = function(status){\n  // handle IE9 bug: http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n  if (status === 1223) {\n    status = 204;\n  }\n\n  var type = status / 100 | 0;\n\n  // status / class\n  this.status = this.statusCode = status;\n  this.statusType = type;\n\n  // basics\n  this.info = 1 == type;\n  this.ok = 2 == type;\n  this.clientError = 4 == type;\n  this.serverError = 5 == type;\n  this.error = (4 == type || 5 == type)\n    ? this.toError()\n    : false;\n\n  // sugar\n  this.accepted = 202 == status;\n  this.noContent = 204 == status;\n  this.badRequest = 400 == status;\n  this.unauthorized = 401 == status;\n  this.notAcceptable = 406 == status;\n  this.notFound = 404 == status;\n  this.forbidden = 403 == status;\n};\n\n/**\n * Return an `Error` representative of this response.\n *\n * @return {Error}\n * @api public\n */\n\nResponse.prototype.toError = function(){\n  var req = this.req;\n  var method = req.method;\n  var url = req.url;\n\n  var msg = 'cannot ' + method + ' ' + url + ' (' + this.status + ')';\n  var err = new Error(msg);\n  err.status = this.status;\n  err.method = method;\n  err.url = url;\n\n  return err;\n};\n\n/**\n * Expose `Response`.\n */\n\nrequest.Response = Response;\n\n/**\n * Initialize a new `Request` with the given `method` and `url`.\n *\n * @param {String} method\n * @param {String} url\n * @api public\n */\n\nfunction Request(method, url) {\n  var self = this;\n  Emitter.call(this);\n  this._query = this._query || [];\n  this.method = method;\n  this.url = url;\n  this.header = {};\n  this._header = {};\n  this.on('end', function(){\n    var err = null;\n    var res = null;\n\n    try {\n      res = new Response(self);\n    } catch(e) {\n      err = new Error('Parser is unable to parse the response');\n      err.parse = true;\n      err.original = e;\n      // issue #675: return the raw response if the response parsing fails\n      err.rawResponse = self.xhr && self.xhr.responseText ? self.xhr.responseText : null;\n      return self.callback(err);\n    }\n\n    self.emit('response', res);\n\n    if (err) {\n      return self.callback(err, res);\n    }\n\n    if (res.status >= 200 && res.status < 300) {\n      return self.callback(err, res);\n    }\n\n    var new_err = new Error(res.statusText || 'Unsuccessful HTTP response');\n    new_err.original = err;\n    new_err.response = res;\n    new_err.status = res.status;\n\n    self.callback(new_err, res);\n  });\n}\n\n/**\n * Mixin `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Allow for extension\n */\n\nRequest.prototype.use = function(fn) {\n  fn(this);\n  return this;\n}\n\n/**\n * Set timeout to `ms`.\n *\n * @param {Number} ms\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.timeout = function(ms){\n  this._timeout = ms;\n  return this;\n};\n\n/**\n * Clear previous timeout.\n *\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.clearTimeout = function(){\n  this._timeout = 0;\n  clearTimeout(this._timer);\n  return this;\n};\n\n/**\n * Abort the request, and clear potential timeout.\n *\n * @return {Request}\n * @api public\n */\n\nRequest.prototype.abort = function(){\n  if (this.aborted) return;\n  this.aborted = true;\n  this.xhr.abort();\n  this.clearTimeout();\n  this.emit('abort');\n  return this;\n};\n\n/**\n * Set header `field` to `val`, or multiple fields with one object.\n *\n * Examples:\n *\n *      req.get('/')\n *        .set('Accept', 'application/json')\n *        .set('X-API-Key', 'foobar')\n *        .end(callback);\n *\n *      req.get('/')\n *        .set({ Accept: 'application/json', 'X-API-Key': 'foobar' })\n *        .end(callback);\n *\n * @param {String|Object} field\n * @param {String} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.set = function(field, val){\n  if (isObject(field)) {\n    for (var key in field) {\n      this.set(key, field[key]);\n    }\n    return this;\n  }\n  this._header[field.toLowerCase()] = val;\n  this.header[field] = val;\n  return this;\n};\n\n/**\n * Remove header `field`.\n *\n * Example:\n *\n *      req.get('/')\n *        .unset('User-Agent')\n *        .end(callback);\n *\n * @param {String} field\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.unset = function(field){\n  delete this._header[field.toLowerCase()];\n  delete this.header[field];\n  return this;\n};\n\n/**\n * Get case-insensitive header `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api private\n */\n\nRequest.prototype.getHeader = function(field){\n  return this._header[field.toLowerCase()];\n};\n\n/**\n * Set Content-Type to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.xml = 'application/xml';\n *\n *      request.post('/')\n *        .type('xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n *      request.post('/')\n *        .type('application/xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n * @param {String} type\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.type = function(type){\n  this.set('Content-Type', request.types[type] || type);\n  return this;\n};\n\n/**\n * Force given parser\n *\n * Sets the body parser no matter type.\n *\n * @param {Function}\n * @api public\n */\n\nRequest.prototype.parse = function(fn){\n  this._parser = fn;\n  return this;\n};\n\n/**\n * Set Accept to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.json = 'application/json';\n *\n *      request.get('/agent')\n *        .accept('json')\n *        .end(callback);\n *\n *      request.get('/agent')\n *        .accept('application/json')\n *        .end(callback);\n *\n * @param {String} accept\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.accept = function(type){\n  this.set('Accept', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Authorization field value with `user` and `pass`.\n *\n * @param {String} user\n * @param {String} pass\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.auth = function(user, pass){\n  var str = btoa(user + ':' + pass);\n  this.set('Authorization', 'Basic ' + str);\n  return this;\n};\n\n/**\n* Add query-string `val`.\n*\n* Examples:\n*\n*   request.get('/shoes')\n*     .query('size=10')\n*     .query({ color: 'blue' })\n*\n* @param {Object|String} val\n* @return {Request} for chaining\n* @api public\n*/\n\nRequest.prototype.query = function(val){\n  if ('string' != typeof val) val = serialize(val);\n  if (val) this._query.push(val);\n  return this;\n};\n\n/**\n * Write the field `name` and `val` for \"multipart/form-data\"\n * request bodies.\n *\n * ``` js\n * request.post('/upload')\n *   .field('foo', 'bar')\n *   .end(callback);\n * ```\n *\n * @param {String} name\n * @param {String|Blob|File} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.field = function(name, val){\n  if (!this._formData) this._formData = new root.FormData();\n  this._formData.append(name, val);\n  return this;\n};\n\n/**\n * Queue the given `file` as an attachment to the specified `field`,\n * with optional `filename`.\n *\n * ``` js\n * request.post('/upload')\n *   .attach(new Blob(['<a id=\"a\"><b id=\"b\">hey!</b></a>'], { type: \"text/html\"}))\n *   .end(callback);\n * ```\n *\n * @param {String} field\n * @param {Blob|File} file\n * @param {String} filename\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.attach = function(field, file, filename){\n  if (!this._formData) this._formData = new root.FormData();\n  this._formData.append(field, file, filename);\n  return this;\n};\n\n/**\n * Send `data`, defaulting the `.type()` to \"json\" when\n * an object is given.\n *\n * Examples:\n *\n *       // querystring\n *       request.get('/search')\n *         .end(callback)\n *\n *       // multiple data \"writes\"\n *       request.get('/search')\n *         .send({ search: 'query' })\n *         .send({ range: '1..5' })\n *         .send({ order: 'desc' })\n *         .end(callback)\n *\n *       // manual json\n *       request.post('/user')\n *         .type('json')\n *         .send('{\"name\":\"tj\"}')\n *         .end(callback)\n *\n *       // auto json\n *       request.post('/user')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // manual x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send('name=tj')\n *         .end(callback)\n *\n *       // auto x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // defaults to x-www-form-urlencoded\n  *      request.post('/user')\n  *        .send('name=tobi')\n  *        .send('species=ferret')\n  *        .end(callback)\n *\n * @param {String|Object} data\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.send = function(data){\n  var obj = isObject(data);\n  var type = this.getHeader('Content-Type');\n\n  // merge\n  if (obj && isObject(this._data)) {\n    for (var key in data) {\n      this._data[key] = data[key];\n    }\n  } else if ('string' == typeof data) {\n    if (!type) this.type('form');\n    type = this.getHeader('Content-Type');\n    if ('application/x-www-form-urlencoded' == type) {\n      this._data = this._data\n        ? this._data + '&' + data\n        : data;\n    } else {\n      this._data = (this._data || '') + data;\n    }\n  } else {\n    this._data = data;\n  }\n\n  if (!obj || isHost(data)) return this;\n  if (!type) this.type('json');\n  return this;\n};\n\n/**\n * Invoke the callback with `err` and `res`\n * and handle arity check.\n *\n * @param {Error} err\n * @param {Response} res\n * @api private\n */\n\nRequest.prototype.callback = function(err, res){\n  var fn = this._callback;\n  this.clearTimeout();\n  fn(err, res);\n};\n\n/**\n * Invoke callback with x-domain error.\n *\n * @api private\n */\n\nRequest.prototype.crossDomainError = function(){\n  var err = new Error('Request has been terminated\\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.');\n  err.crossDomain = true;\n\n  err.status = this.status;\n  err.method = this.method;\n  err.url = this.url;\n\n  this.callback(err);\n};\n\n/**\n * Invoke callback with timeout error.\n *\n * @api private\n */\n\nRequest.prototype.timeoutError = function(){\n  var timeout = this._timeout;\n  var err = new Error('timeout of ' + timeout + 'ms exceeded');\n  err.timeout = timeout;\n  this.callback(err);\n};\n\n/**\n * Enable transmission of cookies with x-domain requests.\n *\n * Note that for this to work the origin must not be\n * using \"Access-Control-Allow-Origin\" with a wildcard,\n * and also must set \"Access-Control-Allow-Credentials\"\n * to \"true\".\n *\n * @api public\n */\n\nRequest.prototype.withCredentials = function(){\n  this._withCredentials = true;\n  return this;\n};\n\n/**\n * Initiate request, invoking callback `fn(res)`\n * with an instanceof `Response`.\n *\n * @param {Function} fn\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.end = function(fn){\n  var self = this;\n  var xhr = this.xhr = request.getXHR();\n  var query = this._query.join('&');\n  var timeout = this._timeout;\n  var data = this._formData || this._data;\n\n  // store callback\n  this._callback = fn || noop;\n\n  // state change\n  xhr.onreadystatechange = function(){\n    if (4 != xhr.readyState) return;\n\n    // In IE9, reads to any property (e.g. status) off of an aborted XHR will\n    // result in the error \"Could not complete the operation due to error c00c023f\"\n    var status;\n    try { status = xhr.status } catch(e) { status = 0; }\n\n    if (0 == status) {\n      if (self.timedout) return self.timeoutError();\n      if (self.aborted) return;\n      return self.crossDomainError();\n    }\n    self.emit('end');\n  };\n\n  // progress\n  var handleProgress = function(e){\n    if (e.total > 0) {\n      e.percent = e.loaded / e.total * 100;\n    }\n    self.emit('progress', e);\n  };\n  if (this.hasListeners('progress')) {\n    xhr.onprogress = handleProgress;\n  }\n  try {\n    if (xhr.upload && this.hasListeners('progress')) {\n      xhr.upload.onprogress = handleProgress;\n    }\n  } catch(e) {\n    // Accessing xhr.upload fails in IE from a web worker, so just pretend it doesn't exist.\n    // Reported here:\n    // https://connect.microsoft.com/IE/feedback/details/837245/xmlhttprequest-upload-throws-invalid-argument-when-used-from-web-worker-context\n  }\n\n  // timeout\n  if (timeout && !this._timer) {\n    this._timer = setTimeout(function(){\n      self.timedout = true;\n      self.abort();\n    }, timeout);\n  }\n\n  // querystring\n  if (query) {\n    query = request.serializeObject(query);\n    this.url += ~this.url.indexOf('?')\n      ? '&' + query\n      : '?' + query;\n  }\n\n  // initiate request\n  xhr.open(this.method, this.url, true);\n\n  // CORS\n  if (this._withCredentials) xhr.withCredentials = true;\n\n  // body\n  if ('GET' != this.method && 'HEAD' != this.method && 'string' != typeof data && !isHost(data)) {\n    // serialize stuff\n    var contentType = this.getHeader('Content-Type');\n    var serialize = this._parser || request.serialize[contentType ? contentType.split(';')[0] : ''];\n    if (!serialize && isJSON(contentType)) serialize = request.serialize['application/json'];\n    if (serialize) data = serialize(data);\n  }\n\n  // set header fields\n  for (var field in this.header) {\n    if (null == this.header[field]) continue;\n    xhr.setRequestHeader(field, this.header[field]);\n  }\n\n  // send stuff\n  this.emit('request', this);\n\n  // IE11 xhr.send(undefined) sends 'undefined' string as POST payload (instead of nothing)\n  // We need null here if data is undefined\n  xhr.send(typeof data !== 'undefined' ? data : null);\n  return this;\n};\n\n/**\n * Faux promise support\n *\n * @param {Function} fulfill\n * @param {Function} reject\n * @return {Request}\n */\n\nRequest.prototype.then = function (fulfill, reject) {\n  return this.end(function(err, res) {\n    err ? reject(err) : fulfill(res);\n  });\n}\n\n/**\n * Expose `Request`.\n */\n\nrequest.Request = Request;\n\n/**\n * Issue a request:\n *\n * Examples:\n *\n *    request('GET', '/users').end(callback)\n *    request('/users').end(callback)\n *    request('/users', callback)\n *\n * @param {String} method\n * @param {String|Function} url or callback\n * @return {Request}\n * @api public\n */\n\nfunction request(method, url) {\n  // callback\n  if ('function' == typeof url) {\n    return new Request('GET', method).end(url);\n  }\n\n  // url first\n  if (1 == arguments.length) {\n    return new Request('GET', method);\n  }\n\n  return new Request(method, url);\n}\n\n/**\n * GET `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.get = function(url, data, fn){\n  var req = request('GET', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.query(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * HEAD `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.head = function(url, data, fn){\n  var req = request('HEAD', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * DELETE `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nfunction del(url, fn){\n  var req = request('DELETE', url);\n  if (fn) req.end(fn);\n  return req;\n};\n\nrequest.del = del;\nrequest.delete = del;\n\n/**\n * PATCH `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.patch = function(url, data, fn){\n  var req = request('PATCH', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * POST `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.post = function(url, data, fn){\n  var req = request('POST', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * PUT `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.put = function(url, data, fn){\n  var req = request('PUT', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * Expose `request`.\n */\n\nmodule.exports = request;\n","/* global localStorage */\r\nvar Table = require('./table');\r\n\r\nmodule.exports = class Database {\r\n  constructor (name, options) {\r\n    this.url = name || '/api/';\r\n    if (!this.url.match(/\\/$/)) {\r\n      this.url += '/';\r\n    }\r\n\r\n    options = options || {};\r\n    this.odata = options.odata || false;\r\n    this.cacheTTL = options.cacheTTL || 10 * 60 * 1000; // 10 minutes\r\n    this.cacheByDefault = options.cacheByDefault || false;\r\n    this.storage = options.storage || localStorage;\r\n    this.plugins = options.plugins || [];\r\n    this.onEnd = options.onEnd || false;\r\n\r\n    var self = this;\r\n    var _database = function (table) {\r\n      return new Table(self, table);\r\n    };\r\n    // `public` functions\r\n    this.plugins.forEach(plugin => {\r\n      plugin.call(self);\r\n    });\r\n\r\n    return _database;\r\n  }\r\n};\r\n","// The Export Module\r\nglobal.Unrest = require('./database');\r\nglobal.Unrest.superagent = require('superagent');\r\n\r\nmodule.exports = global.Unrest;\r\n","var parser = require('odata-filter-parser');\r\n\r\nmodule.exports = class Odata {\r\n  constructor(query) {\r\n    this._query = query;\r\n  }\r\n  toString() {\r\n    var g = [],\r\n      q = this._query;\r\n    console.log(q);\r\n    if (q.order.length > 0) {\r\n      var b = \"$orderby=\";\r\n      q.order.forEach(i => {\r\n        b += i[0] + (i[1] == \"desc\" ? \" desc\" : \"\") + \",\";\r\n      });\r\n      b = b.substring(0, b.length - 1);\r\n      g.push(b);\r\n    }\r\n    if (q.skip) g.push(\"$skip=\" + parseInt(q.skip));\r\n    if (q.take) g.push(\"$top=\" + parseInt(q.take));\r\n    if (q.where.length > 0) {\r\n      var b = \"$filter=\";\r\n      q.where.forEach(i => {\r\n        b += (new parser.Predicate(i)).serialize() + \" and \";\r\n      })\r\n      b = b.substring(0, b.length - 5);\r\n      g.push(b);\r\n    }\r\n    if (q.select.length > 0) g.push(\"$select=\" + q.select.join(\",\"));\r\n    return g.join(\"&\");\r\n  }\r\n};\r\n","module.exports = class Query {\r\n  constructor() {\r\n    this._query = {\r\n      order: [],\r\n      select: [],\r\n      where: [],\r\n      skip: null,\r\n      take: null\r\n    }\r\n  }\r\n  orderBy(...args) {\r\n    args.forEach(arg => {\r\n      this._query.order.push([\r\n        arg[0] == '-' ? arg.substring(1, arg.length) : arg,\r\n        arg[0] == '-' ? 'desc' : 'asc'\r\n      ]);\r\n    })\r\n    return this;\r\n  }\r\n  select(...args) {\r\n    args.forEach(arg => {\r\n      this._query.select.push(arg);\r\n    })\r\n    return this;\r\n  }\r\n  where(pred) {\r\n    this._query.where.push(pred);\r\n    return this;\r\n  }\r\n  skip(amount) {\r\n    this._query.skip = amount;\r\n    return this;\r\n  }\r\n  take(amount) {\r\n    this._query.take = amount;\r\n    return this;\r\n  }\r\n};\r\n","var xhr = require('superagent');\r\nvar odata = require('./odata');\r\n\r\nfunction jsonify(agent) {\r\n  return agent.type('application/json')\r\n    .accept('json');\r\n}\r\n\r\nfunction handleResponses(request) {\r\n  request._status = 'pending';\r\n  request.pending = true;\r\n  var method = request._agent.method;\r\n  var url = request._agent.url;\r\n  const CACHE_KEY = 'unrest-' + method + '-' + url;\r\n  var storageProvider = request._table._database.storage;\r\n\r\n  // //\r\n  // Perform Cache\r\n  if (request._cache) {\r\n    var cache = JSON.parse(storageProvider.getItem(CACHE_KEY));\r\n\r\n    if (cache) {\r\n      // if the cache exists and isn't old\r\n      if (cache.time && request._cache > +(new Date()) - cache.time) {\r\n        request._onSuccess.forEach(function(cb) {\r\n          cb(cache.data, true);\r\n        });\r\n        request._cachedata = cache.data;\r\n      } else {\r\n        storageProvider.removeItem(CACHE_KEY);\r\n      }\r\n    }\r\n  }\r\n\r\n  // //\r\n  // Handle Response\r\n  request._agent.end(function(err, res) {\r\n    request._status = 'resolved';\r\n    delete request.pending;\r\n    if (err) { // on error\r\n      request.error = err;\r\n      // debugger;\r\n      request._onError.forEach(function(cb) {\r\n        cb(err);\r\n      });\r\n    } else { // on success\r\n      request._data = res.body;\r\n      if (request._cache) {\r\n        storageProvider.setItem(CACHE_KEY, JSON.stringify({\r\n          time: +new Date(),\r\n          data: request._data\r\n        }));\r\n      }\r\n      // //\r\n      // perform injection\r\n      if (typeof(res.body) === 'object' && !Array.isArray(res.body)) {\r\n        for (var prop in request._data) {\r\n          request[prop] = request._data[prop];\r\n        }\r\n      } else {\r\n        request.data = request._data;\r\n      }\r\n      // //\r\n      // perform calbacks.\r\n      request._onSuccess.forEach(function(cb) {\r\n        cb(res.body);\r\n      });\r\n    }\r\n    if( request._table._database.onEnd ) request._table._database.onEnd();\r\n\r\n  });\r\n}\r\n\r\nmodule.exports = class Request {\r\n  constructor(table) {\r\n    this._table = table;\r\n    this._status = 'idle';\r\n    this._onSuccess = [];\r\n    this._onError = [];\r\n    if (this._table._database.cacheByDefault) {\r\n      this._cache = this._table._database.cacheTTL;\r\n    }\r\n  }\r\n\r\n  cacheable(lifetime) {\r\n    if (this._status !== 'idle' && this._status !== 'pending') {\r\n      console.error('cacheable could not be set before request was sent out. Ensure this is called before query, fetch, save, then, etc');\r\n    }\r\n    if (!lifetime) {\r\n      lifetime = this._table._database.cacheTTL;\r\n    }\r\n    this._cache = lifetime;\r\n    return this;\r\n  }\r\n\r\n  odata() {\r\n    return this._table._database.odata;\r\n  }\r\n\r\n  resource(id) {\r\n    id = id.toString();\r\n    return this._table.url + (this.odata() ? '(' + id + ')' : '/' + id);\r\n  }\r\n  // QUERY GET /table/\r\n  // Returns a list.\r\n  query(options) {\r\n    this._agent = xhr\r\n      .get(this._table.url\r\n        + ( this.odata() ? \"?\" + (new odata(this._table._query)).toString() : \"\"))\r\n      .query(options);\r\n    jsonify(this._agent);\r\n    if (this._status === 'idle') handleResponses(this);\r\n    return this;\r\n  }\r\n\r\n  fetch(id, options) {\r\n    this._agent = xhr\r\n      .get( this.resource(id) )\r\n      .query(options);\r\n    jsonify(this._agent);\r\n    if (this._status === 'idle') handleResponses(this);\r\n    return this;\r\n  }\r\n\r\n  save(obj) {\r\n    var r = null;\r\n    var id = obj.Id || obj.id;\r\n    if (!id || id === 0) {\r\n      r = xhr.post(this._table.url);\r\n    } else {\r\n      r = xhr.put(this.resource(id));\r\n    }\r\n    this._agent = r.send(obj);\r\n    jsonify(this._agent);\r\n    if (this._status === 'idle') handleResponses(this);\r\n    return this;\r\n  }\r\n\r\n  remove(Id) {\r\n    this._agent = xhr.del(this.resource(Id));\r\n    jsonify(this._agent);\r\n    return this;\r\n  }\r\n\r\n  then(cb) {\r\n    if (this._status === 'resolved' && !this.error) {\r\n      cb(this._data);\r\n    } else {\r\n      this._onSuccess.push(cb);\r\n    }\r\n    if (this._status === 'idle') handleResponses(this);\r\n    if (this._status === 'pending' && this._cachedata) {\r\n      cb(this._cachedata, true);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  catch (cb) {\r\n    if (this._status === 'resolved' && this.error) {\r\n      cb(this.error);\r\n    } else {\r\n      this._onError.push(cb);\r\n    }\r\n    if (this._status === 'idle') handleResponses(this);\r\n    return this;\r\n  }\r\n\r\n  status() {\r\n    return this._status;\r\n  }\r\n};\r\n","var Request = require('./request');\r\nvar Query = require('./query');\r\n\r\nmodule.exports = class Table extends Query {\r\n    constructor (database, table) {\r\n      super();\r\n      this._database = database;\r\n      this.url = database.url + table;\r\n      this.name = table;\r\n      this.events = {};\r\n    }\r\n\r\n    query (options) {\r\n      return new Request(this).query(options);\r\n    }\r\n\r\n    fetch (id) {\r\n      return new Request(this).fetch(id);\r\n    }\r\n\r\n    save (object) {\r\n      return new Request(this).save(object);\r\n    }\r\n\r\n    remove (obj) {\r\n      return new Request(this).remove(obj);\r\n    }\r\n\r\n    cacheable (obj) {\r\n      return new Request(this).cacheable(obj);\r\n    }\r\n};\r\n"],"sourceRoot":"/source/"}